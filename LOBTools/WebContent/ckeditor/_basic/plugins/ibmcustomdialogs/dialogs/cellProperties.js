CKEDITOR.tools.extend(CKEDITOR.ibm.dialogs,{cellProperties:function(w,d){function A(a,b){var c=function(){this.removeListener("show",c);b(this,this._.parentDialog)};if(d._.storedDialogs.colordialog)d._.storedDialogs.colordialog.on("show",c);else CKEDITOR.on("dialogDefinition",function(b){if(b.data.name==a){var d=b.data.definition;b.removeListener();d.onLoad=CKEDITOR.tools.override(d.onLoad,function(a){return function(){this.on("show",c);d.onLoad=a;"function"==typeof a&&a.call(this)}})}})}function p(a){var b=
a.substring(4,a.length-1).split(",");if(0<=b[0]&&255>=b[0]&&0<=b[1]&&255>=b[1]&&0<=b[2]&&255>=b[2]){a=parseInt(b[0]).toString(16);"0"==a&&(a="00");var c=parseInt(b[1]).toString(16);"0"==c&&(c="00");b=parseInt(b[2]).toString(16);"0"==b&&(b="00");return"#"+a+c+b}return!1}function x(a){var b=a.substring(1,2),c=a.substring(2,3),a=a.substring(3);return"#"+b+b+c+c+a+a}if("cellProperties"===w.dialog.getName()){w.title=d.lang.table.cell.ibm.title;var e=w.getContents("info"),l=e.get("width"),k=e.get("widthType"),
o=e.get("height"),q=e.get("wordWrap"),r=e.get("hAlign"),s=e.get("vAlign"),t=e.get("cellType"),y=e.get("rowSpan"),z=e.get("colSpan"),f=e.get("bgColor"),g=e.get("borderColor"),i=e.get("bgColorChoose"),h=e.get("borderColorChoose"),B=e.get("requiredLabel")?e.get("requiredLabel"):{type:"html",html:""};l.labelLayout=null;l.widths=null;l.width=null;l.setup=function(a){var b=parseFloat(a[0].getAttribute("width")),a=parseFloat(a[0].getStyle("width"));!isNaN(b)&&this.setValue(b);!isNaN(a)&&this.setValue(a)};
l.commit=function(a){var b=parseFloat(this.getValue()),c=this.getDialog().getValueOf("info","widthType");isNaN(b)?a.removeStyle("width"):a.setStyle("width",b+c);a.removeAttribute("width")};k.labelLayout=null;k.widths=null;k.style=this.styleWidth100Pc;k.labelStyle=null;k.items=[[d.lang.table.widthPx,"px"],[d.lang.table.widthPc,"%"],[d.lang.ibm.common.widthIn,"in"],[d.lang.ibm.common.widthCm,"cm"],[d.lang.ibm.common.widthMm,"mm"],[d.lang.ibm.common.widthEm,"em"],[d.lang.ibm.common.widthEx,"ex"],[d.lang.ibm.common.widthPt,
"pt"],[d.lang.ibm.common.widthPc,"pc"]];k.setup=function(a){(a=/^(\d+(?:\.\d+)?)(px|%|in|cm|mm|em|ex|pt|pc)$/.exec(a[0].getStyle("width")||a[0].getAttribute("width")))&&this.setValue(a[2])};o.labelLayout=null;o.widths=null;o.width=null;delete o.onLoad;q.labelLayout=null;q.widths=null;q.style=this.styleWidth100Pc;r.labelLayout=null;r.widths=null;r.style=this.styleWidth100Pc;s.labelLayout=null;s.widths=null;s.style=this.styleWidth100Pc;t.labelLayout=null;t.widths=null;t.style=this.styleWidth100Pc;y.labelLayout=
null;y.widths=null;z.labelLayout=null;z.widths=null;h.style="";f.setup&&(f.origSetup=f.setup);f.setup=function(a){this.getElement().hide();this.origSetup&&this.origSetup(a);j(this.getValue(),m)};f.commit=function(){};f.onChange&&(f.origOnChange=f.onChange);f.onChange=function(a){this.origOnChange&&this.origOnChange(a);var a=this.getValue(),b=CKEDITOR.document.createElement("div");b.setStyle("background-color",a);b.getStyle("background-color")||(a="");u(this.getDialog().getContentElement("info","bgColorList"),
a);j(a,m)};g.setup&&(g.origSetup=g.setup);g.setup=function(a){this.getElement().hide();this.origSetup&&this.origSetup(a);j(this.getValue(),n)};g.commit=function(){};g.onChange&&(g.origOnChange=g.onChange);g.onChange=function(a){this.origOnChange&&this.origOnChange(a);var a=this.getValue(),b=CKEDITOR.document.createElement("div");b.setStyle("border-color",a);b.getStyle("border-color")||(a="");u(this.getDialog().getContentElement("info","borderColorList"),a);j(a,n)};i.onLoad&&(i.origOnLoad=i.onLoad);
i.onLoad=function(){if(CKEDITOR.env.hc)this.getElement().hide();else{this.getElement().show();this.origOnLoad&&this.origOnLoad();this.getElement().getParent().setStyle("padding-bottom","5px")}};h.onLoad&&(h.origOnLoad=h.onLoad);h.onLoad=function(){if(CKEDITOR.env.hc)this.getElement().hide();else{this.getElement().show();this.origOnLoad&&this.origOnLoad();this.getElement().getParent().setStyle("padding-bottom","5px")}};var v=function(){var a=d.lang,b=a.colorbutton.colors,a=[[a.common.notSet,""]];div=
CKEDITOR.document.createElement("div");for(var c in b){div.setStyle("border-color","#"+c);a.push([b[c],div.getStyle("border-color")])}return a.sort(function(a,b){return a[0]>b[0]})}(),u=function(a,b){var b=b.toLowerCase(),c;b.substring(0,3)=="rgb"?c=p(b):b.substring(0,1)=="#"&&b.length==4&&(c=x(b));for(var d=a==null?this:a,e=d.getInputElement().$,f=e.length;f--;){var g=e.options[f].value.toLowerCase();if(g===b||g===c||p(g)===b){e.options[f].selected="selected";break}}if(f==-1){d.add(b,b);e.options[e.length-
1].selected="selected"}},j=function(a,b){!(a.substring(0,3)=="rgb"&&a.length<=18)&&!(a.substring(0,1)=="#"&&a.length<=7)&&a.indexOf(" ")>=0&&(a="");a?CKEDITOR.document.getById(b).setStyle("background-color",a):CKEDITOR.document.getById(b).removeStyle("background-color")},C={type:"select",id:"borderColorList",items:v,label:d.lang.table.cell.borderColor,style:"width : 100%;",setup:function(a){this.getElement().show();(a=a[0].getStyle("border-color")||a[0].getAttribute("borderColor"))&&u.call(this,null,
a)},commit:function(a){var b=this.getValue();if(b){a.setStyle("border-color",b);a.setStyle("border-style","solid")}else a.removeStyle("border-color");a.removeAttribute("borderColor")},onChange:function(){j(this.getValue(),n)},onKeyUp:function(){j(this.getValue(),n)}},v={type:"select",id:"bgColorList",label:d.lang.table.cell.bgColor,items:v,style:"width : 100%;",setup:function(a){this.getElement().show();(a=a[0].getStyle("background-color")||a[0].getAttribute("bgColor"))&&u.call(this,null,a)},commit:function(a){var b=
this.getValue();b?a.setStyle("background-color",b):a.removeStyle("background-color");a.removeAttribute("bgColor")},onChange:function(){j(this.getValue(),m)},onKeyUp:function(){j(this.getValue(),m)}};i.onClick&&(i.origOnClick=i.onClick);i.onClick=function(){this.origOnClick&&this.origOnClick();var a=this;A("colordialog",function(b){var c=a.getDialog().getContentElement("info","bgColorList").getValue();if(c){c.substring(0,3)=="rgb"?c=p(c):c.substring(0,1)=="#"&&c.length==4&&(c=x(c));c&&b.getContentElement("picker",
"currentColor").setValue(c)}})};h.onClick&&(h.origOnClick=h.onClick);h.onClick=function(){this.origOnClick&&this.origOnClick();var a=this;A("colordialog",function(b){var c=a.getDialog().getContentElement("info","borderColorList").getValue();if(c){c.substring(0,3)=="rgb"?c=p(c):c.substring(0,1)=="#"&&c.length==4&&(c=x(c));c&&b.getContentElement("picker","currentColor").setValue(c)}})};var m=CKEDITOR.tools.getNextId()+"_bgcolorswatch",n=CKEDITOR.tools.getNextId()+"_bordercolorswatch";e.style="width:100%";
e.elements=[{type:"hbox",children:[l,k]},{type:"hbox",children:[o,{type:"select",id:"heightType",style:this.styleWidth100Pc,label:d.lang.table.ibm.heightUnit,"default":"px",items:[[d.lang.table.widthPx,"px"]],setup:function(a){""!==a[0].$.style.height&&/^(\d+(?:\.\d+)?)px$/.exec(a[0].$.style.height)&&this.setValue("px")}}]},{type:"hbox",children:[r,s]},{type:"hbox",children:[q,t]},{type:"hbox",children:[y,z]},{type:"hbox",widths:["70%","5%","25%"],children:[v,{type:"html",html:'<div id="'+m+'" style="border: 1px solid #A0A0A0; height: 20px; width: 20px;"></div>',
onLoad:function(){var a=CKEDITOR.document.getById(m);if(CKEDITOR.env.hc)a.hide();else{a.show();a.getParent().setStyle("vertical-align","bottom")}}},i,f]},{type:"hbox",widths:["70%","5%","25%"],children:[C,{type:"html",html:'<div id="'+n+'" style="border: 1px solid #A0A0A0; height: 20px; width: 20px;"></div>',onLoad:function(){var a=CKEDITOR.document.getById(n);if(CKEDITOR.env.hc)a.hide();else{a.show();a.getParent().setStyle("vertical-align","bottom")}}},h,g]},B]}}},!0);