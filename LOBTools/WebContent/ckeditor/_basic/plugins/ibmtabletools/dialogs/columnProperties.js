CKEDITOR.dialog.add("columnProperties",function(b){var o,k,s,l,c;return{title:b.lang.ibmtabletools.columnTitle,minWidth:220,minHeight:50,onShow:function(){var a=b.getSelection(),f=a.getSelectedElement();a=f&&("td"==f.getName()||"th"==f.getName())?f:(a=a.getCommonAncestor())&&a instanceof CKEDITOR.dom.element&&("td"==a.getName()||"th"==a.getName())?a:a.getAscendant("td")?a.getAscendant("td"):a.getAscendant("th");if(a){l=a.getAscendant("tr");f=l.getChildCount();o=-1;k=0;for(var i,d=0;d<f;d++)if(i=l.getChild(d),
k+=i.getAttribute("colspan")?parseInt(i.getAttribute("colspan"),10):1,a.equals(l.getChild(d))){o=d;break}s=a.getAttribute("colspan")?parseInt(a.getAttribute("colspan"),10):1}var e,a=!1,f=/^(\d+(?:\.\d+)?)(px|%|in|cm|mm|em|ex|pt|pc)$/;i=/^(\d+(?:\.\d+)?)$/;c=[];if(-1!=o)for(var d=l.getAscendant("table"),h,g,j,p=0;p<d.getChildCount();p++)if(h=d.getChild(p),"thead"==h.getName()||"tbody"==h.getName())for(var q=0;q<h.getChildCount();q++){j=g=h.getChild(q);for(var m=0,r=-1,n=0;n<j.getChildCount();n++)if(currentCell=
j.getChild(n),currentColspan=currentCell.getAttribute("colspan")?parseInt(currentCell.getAttribute("colspan"),10):1,m+=currentColspan,m==k){r=currentColspan==s?n:-1;break}else if(m>k){r=-1;break}j=r;-1!=j&&c.push(g.getChild(j))}0<c.length&&(e=c[0].getStyle("width")?c[0].getStyle("width"):c[0].getAttribute("width"));if(void 0==e)a=!0;else{(h=i.exec(e))&&(e+="px");for(g=1;g<c.length;g++)if(d=c[g].getStyle("width")?c[g].getStyle("width"):c[g].getAttribute("width"),(h=i.exec(d))&&(d+="px"),d!=e){a=!0;
break}}!a&&e&&(e=f.exec(e))&&this.setupContent(e)},onOk:function(){for(var a=0;a<c.length;a++)this.commitContent(c[a])},contents:[{id:"info",style:"width: 100%",elements:[{type:"hbox",children:[{label:b.lang.common.width,type:"text",id:"colWidth",setup:function(a){a&&a[1]&&this.setValue(a[1])},commit:function(a){var b=parseFloat(this.getValue(),10),c=this.getDialog().getValueOf("info","widthType");isNaN(b)?a.removeStyle("width"):a.setStyle("width",b+c);a.removeAttribute("width")},validate:CKEDITOR.dialog.validate.number(b.lang.ibmtabletools.invalidColumnWidth)},
{type:"select",id:"widthType",label:b.lang.table.widthUnit,"default":"px",items:[[b.lang.table.widthPx,"px"],[b.lang.table.widthPc,"%"],[b.lang.ibm.common.widthIn,"in"],[b.lang.ibm.common.widthCm,"cm"],[b.lang.ibm.common.widthMm,"mm"],[b.lang.ibm.common.widthEm,"em"],[b.lang.ibm.common.widthEx,"ex"],[b.lang.ibm.common.widthPt,"pt"],[b.lang.ibm.common.widthPc,"pc"]],setup:function(a){a&&a[2]&&this.setValue(a[2])}}]}]}]}});