(function(){var s=!1,y=function(b,k){function y(){var a=arguments,c=this.getContentElement("advanced","txtdlgGenStyle");c&&c.commit.apply(c,a);this.foreach(function(c){c.commit&&"txtdlgGenStyle"!=c.id&&c.commit.apply(c,a)})}function n(a){if(!z){z=1;var c=this.getDialog(),d=c.imageElement;if(d){this.commit(f,d);for(var a=[].concat(a),e=a.length,b,A=0;A<e;A++)(b=c.getContentElement.apply(c,a[A].split(":")))&&b.setup(f,d)}z=0}}function I(a){var c=!0,d=a.getContentElement("Upload","browseFileButton").getInputElement().$,
a=a.getContentElement("Upload","selectedFile").getInputElement().$,e=null;if(!h.test(a.value)&&a.value!==b.lang.ibmuploadimage.ibm.noFileChosen)return alert(b.lang.ibmuploadimage.ibm.notImageFile),loadingImage.setStyle("visibility","hidden"),!1;if(!a||!a.value||""===a.value||a.value===b.lang.ibmuploadimage.ibm.noFileChosen)return c=!1,alert(b.lang.ibmuploadimage.ibm.notImageFile),c;if(CKEDITOR.env.ie&&10>CKEDITOR.env.version)try{e=(new ActiveXObject("Scripting.FileSystemObject")).getFile(a.value).size}catch(g){"undefined"!==
typeof console&&console.log(g.message);alert(b.lang.ibmuploadimage.ibm.enableActiveX);return}else e=d.files[0]&&d.files[0].size||null;if(!e)return!1;e&&e/1048576>J&&(alert(b.lang.ibmuploadimage.ibm.imageSize),loadingImage.setStyle("visibility","hidden"),c=!1);return c}function K(a,c,d){var b=!1,g=-1,f,h=c.getContentElement("Upload","browseFileButton").getInputElement().$,m=h.parentNode,i=c.getButton("progressButton").getChild(0).getElement();if(CKEDITOR.env.ie&&10>CKEDITOR.env.version){var j=document.getElementById(c.getContentElement("Upload",
"browseFileButton")._.frameId),k=j.contentWindow.document.getElementsByTagName("html")[0].innerHTML,k="<html>"+k+"</html>",l=j.cloneNode(!0);c.on("cancel",function(){b=!0});var n=function(){"undefined"==typeof a._.filebrowserSe&&(a._.filebrowserSe={getDialog:function(){return{getContentElement:function(){return{reset:function(){}}}}},"for":[],filebrowser:{onSelect:function(){}}});j.detachEvent("onreadystatechange",n)};j.attachEvent("onreadystatechange",n);var p=function(){if(t){var c=parseInt(t);
0<c&&(o=setTimeout(function(){var c=j.parentNode;j.removeNode(!0);c.appendChild(l);l.contentWindow.document.open();l.contentWindow.document.writeln(k);l.contentWindow.document.close();i.setStyle("visibility","hidden");alert(a.lang.ibmuploadimage.ibm.fileUploadTimeout);s=!1;o=null},c))}j.detachEvent("onreadystatechange",p)};j.attachEvent("onreadystatechange",p);s||(j.attachEvent("onload",function(){try{var d=j.contentWindow.document.getElementsByTagName("head")[0].innerHTML.match(/(<script[^>]*>)?\W*window\.parent\.CKEDITOR\.tools\.callFunction\(\W*\d*\W*,\W*\[["']{1}(.*?)["']{1}\]\W*\);?\W*(<\/script>)?/i);
if(d&&!b)o&&clearTimeout(o),c.getContentElement("info","txtUrl").getInputElement().$.value=d[2],c.getButton("progressButton").getChild(0).getElement().setStyle("visibility","hidden"),!1!==c.fire("ok",{hide:!0}).hide&&(c.getButton("progressButton").getChild(0).getElement().setStyle("visibility","hidden"),c.hide());else{o&&clearTimeout(o);var g=j.parentNode;j.removeNode(!0);g.appendChild(l);l.contentWindow.document.open();l.contentWindow.document.writeln(k);l.contentWindow.document.close();i.setStyle("visibility",
"hidden");s=!1}}catch(f){o&&clearTimeout(o),"unknown"==typeof j.contentWindow?clearTimeout(o):(g=j.parentNode,j.removeNode(!0),g.appendChild(l),l.contentWindow.document.open(),l.contentWindow.document.writeln(k),l.contentWindow.document.close(),i.setStyle("visibility","hidden"),alert(a.lang.ibmuploadimage.ibm.serverUnreachable),s=!1)}}),s=!0);m.submit()}else{g=new XMLHttpRequest;f=new FormData;f.append("file",h.files[0]);try{if(g.open("POST",m.action,!0),g.onreadystatechange=function(){if(g.status&&
4==g.readyState)if(200==g.status){var f=g.responseText.match(/(<script[^>]*>)?\W*window\.parent\.CKEDITOR\.tools\.callFunction\(\W*\d*\W*,\W*\[["']{1}(.*?)["']{1}\]\W*\);?\W*(<\/script>)?/i);f&&CKEDITOR.tools.callFunction(d,f[2],c)}else b=!0,alert(a.lang.ibmuploadimage.ibm.serverUnreachable),i.setStyle("visibility","hidden")},g.send(f),c.on("cancel",function(){g.abort();b=!0}),t){var q=parseInt(t);0<q&&setTimeout(function(){200!==g.status&&!b&&(g.abort(),alert(a.lang.ibmuploadimage.ibm.fileUploadTimeout),
i.setStyle("visibility","hidden"))},q)}}catch(r){b=!0}}}var f=1,u=/^\s*(\d+)((px)|\%)?\s*$/i,D=/(^\s*(\d+)((px)|\%)?\s*$)|^$/i,v=/^\d+px$/,E=function(){var a=this.getValue(),c=this.getDialog(),d=a.match(u);d&&("%"==d[2]&&p(c,!1),a=d[1]);c.lockRatio&&(d=c.originalElement,"true"==d.getCustomData("isReady")&&("txtHeight"==this.id?(a&&"0"!=a&&(a=Math.round(d.$.width*(a/d.$.height))),isNaN(a)||c.setValueOf("info","txtWidth",a)):(a&&"0"!=a&&(a=Math.round(d.$.height*(a/d.$.width))),isNaN(a)||c.setValueOf("info",
"txtHeight",a))));m(c)},m=function(a){if(!a.originalElement||!a.preview)return 1;a.commitContent(4,a.preview);return 0},z,p=function(a,c){if(!a.getContentElement("info","ratioLock"))return null;var d=a.originalElement;if(!d)return null;if("check"==c){if(!a.userlockRatio&&"true"==d.getCustomData("isReady")){var b=a.getValueOf("info","txtWidth"),g=a.getValueOf("info","txtHeight"),d=1E3*d.$.width/d.$.height,f=1E3*b/g;a.lockRatio=!1;!b&&!g?a.lockRatio=!0:!isNaN(d)&&!isNaN(f)&&Math.round(d)==Math.round(f)&&
(a.lockRatio=!0)}}else void 0!=c?a.lockRatio=c:(a.userlockRatio=1,a.lockRatio=!a.lockRatio);b=CKEDITOR.document.getById(w);a.lockRatio?b.removeClass("cke_btn_unlocked"):b.addClass("cke_btn_unlocked");b.setAttribute("aria-checked",a.lockRatio);CKEDITOR.env.hc&&b.getChild(0).setHtml(a.lockRatio?CKEDITOR.env.ie?"■":"▣":CKEDITOR.env.ie?"□":"▢");return a.lockRatio},F=function(a){var c=a.originalElement;if("true"==c.getCustomData("isReady")){var d=a.getContentElement("info","txtWidth"),b=a.getContentElement("info",
"txtHeight");d&&d.setValue(c.$.width);b&&b.setValue(c.$.height)}m(a)},G=function(a,c){function d(a,c){var d=a.match(u);return d?("%"==d[2]&&(d[1]+="%",p(b,!1)),d[1]):c}if(a==f){var b=this.getDialog(),g="",h="txtWidth"==this.id?"width":"height",i=c.getAttribute(h);i&&(g=d(i,g));g=d(c.getStyle(h),g);this.setValue(g)}},B,x=function(){var a=this.originalElement,c=CKEDITOR.document.getById(q);a.setCustomData("isReady","true");a.removeListener("load",x);a.removeListener("error",i);a.removeListener("abort",
i);c&&c.setStyle("display","none");this.dontResetSize||F(this);this.firstLoad&&CKEDITOR.tools.setTimeout(function(){p(this,"check")},0,this);this.dontResetSize=this.firstLoad=!1},i=function(){var a=this.originalElement,c=CKEDITOR.document.getById(q);a.removeListener("load",x);a.removeListener("error",i);a.removeListener("abort",i);a=CKEDITOR.getUrl(CKEDITOR.plugins.get("ibmuploadimage").path+"images/noimage.png");this.preview&&this.preview.setAttribute("src",a);c&&c.setStyle("display","none");p(this,
!1)},r=function(a){return CKEDITOR.tools.getNextId()+"_"+a},w=r("btnLockSizes"),C=r("btnResetSize"),q=r("ImagePreviewLoader"),L=r("previewLink"),H=r("previewImage"),o,t=b.config.ibmUploadImage.timeout,J=b.config.ibmUploadImage.maxFileSizeLimit,h;if(null!=b.config.ibmUploadImage.supportedFileType){h="\\.(";for(type in b.config.ibmUploadImage.supportedFileType)h+=b.config.ibmUploadImage.supportedFileType[type]+"|";h=h.substring(0,h.length-1);h+=")$";h=RegExp(h,"i")}else h=/\.(gif|jpg|jpeg|tiff|png|svg)$/i;
var M=CKEDITOR.tools.addFunction(function(a,c){c.getContentElement("info","txtUrl").getInputElement().$.value=a;c.getButton("progressButton").getChild(0).getElement().setStyle("visibility","hidden");!1!==c.fire("ok",{hide:!0}).hide&&(c.getButton("progressButton").getChild(0).getElement().setStyle("visibility","hidden"),c.hide())},this),N=null!=b.config.ibmUploadImage.uploadImage?b.config.ibmUploadImage.uploadImage:K,O=null!=b.config.ibmUploadImage.validate?b.config.ibmUploadImage.validate:I;return{title:b.lang.ibmuploadimage["image"==
k?"title":"titleButton"],minWidth:220,minHeight:50,onShow:function(){this.linkEditMode=this.imageEditMode=this.linkElement=this.imageElement=!1;this.lockRatio=!0;this.userlockRatio=0;this.dontResetSize=!1;this.firstLoad=!0;this.addLink=!1;var a=this.getParentEditor(),c=a.getSelection(),d=(c=c&&c.getSelectedElement())&&a.elementPath(c).contains("a",1),b=CKEDITOR.document.getById(q);b&&b.setStyle("display","none");B=new CKEDITOR.dom.element("img",a.document);this.preview=CKEDITOR.document.getById(H);
this.originalElement=a.document.createElement("img");this.originalElement.setAttribute("alt","");this.originalElement.setCustomData("isReady","false");var b=this.definition.dialog.getContentElement("info","imageLinkLabel"),g=this.definition.dialog.getContentElement("info","txtUrl2");b&&g&&g.getInputElement().setAttribute("aria-describedby",b.domId);if(d){this.linkElement=d;this.linkEditMode=!0;b=d.getChildren();if(1==b.count()&&(g=b.getItem(0).getName(),"img"==g||"input"==g))this.imageElement=b.getItem(0),
"img"==this.imageElement.getName()?this.imageEditMode="img":"input"==this.imageElement.getName()&&(this.imageEditMode="input");"image"==k&&this.setupContent(2,d)}if(this.customImageElement)this.imageEditMode="img",this.imageElement=this.customImageElement,delete this.customImageElement;else if(c&&"img"==c.getName()&&!c.data("cke-realelement")||c&&"input"==c.getName()&&"image"==c.getAttribute("type"))this.imageEditMode=c.getName(),this.imageElement=c;this.imageEditMode?(this.cleanImageElement=this.imageElement,
this.imageElement=this.cleanImageElement.clone(!0,!0),this.setupContent(f,this.imageElement),this.selectPage("info")):this.imageElement=a.document.createElement("img");p(this,!0);CKEDITOR.tools.trim(this.getValueOf("info","txtUrl"))||(this.preview.removeAttribute("src"),this.preview.setStyle("display","none"))},onOk:function(){if(this.imageEditMode){var a=this.imageEditMode;"image"==k&&"input"==a&&confirm(b.lang.ibmuploadimage.button2Img)?(this.imageElement=b.document.createElement("img"),this.imageElement.setAttribute("alt",
""),b.insertElement(this.imageElement)):"image"!=k&&"img"==a&&confirm(b.lang.ibmuploadimage.img2Button)?(this.imageElement=b.document.createElement("input"),this.imageElement.setAttributes({type:"image",alt:""}),b.insertElement(this.imageElement)):(this.imageElement=this.cleanImageElement,delete this.cleanImageElement)}else"image"==k?this.imageElement=b.document.createElement("img"):(this.imageElement=b.document.createElement("input"),this.imageElement.setAttribute("type","image")),this.imageElement.setAttribute("alt",
"");this.linkEditMode||(this.linkElement=b.document.createElement("a"));this.commitContent(f,this.imageElement);this.commitContent(2,this.linkElement);this.imageElement.getAttribute("style")||this.imageElement.removeAttribute("style");this.imageEditMode?!this.linkEditMode&&this.addLink?(b.insertElement(this.linkElement),this.imageElement.appendTo(this.linkElement)):this.linkEditMode&&!this.addLink&&(b.getSelection().selectElement(this.linkElement),b.insertElement(this.imageElement)):this.addLink?
this.linkEditMode?b.insertElement(this.imageElement):(b.insertElement(this.linkElement),this.linkElement.append(this.imageElement,!1)):b.insertElement(this.imageElement)},onLoad:function(){"image"!=k&&this.hidePage("Link");var a=this._.element.getDocument();this.getContentElement("info","ratioLock")&&(this.addFocusable(a.getById(w),12),this.addFocusable(a.getById(C),13));this.commitContent=y},onCancel:function(){var a=this.getButton("progressButton").getChild(0).getElement();a&&a.setStyle("visibility",
"hidden")},onHide:function(){this.preview&&this.commitContent(8,this.preview);this.originalElement&&(this.originalElement.removeListener("load",x),this.originalElement.removeListener("error",i),this.originalElement.removeListener("abort",i),this.originalElement.remove(),this.originalElement=!1);delete this.imageElement},contents:[{id:"Upload",filebrowser:"uploadButton",label:b.lang.ibmuploadimage.upload,accessKey:"U",elements:[{type:"vbox",padding:0,width:340,children:[{type:"hbox",padding:0,children:[{type:"html",
id:"fileUploadLabel",style:"margin:0; padding-bottom: 15px; width:100%;",html:"<div>"+CKEDITOR.tools.htmlEncode(b.lang.ibmuploadimage.ibm.fileUpload)+"</div>"}]},{type:"hbox",padding:0,style:"display:none;",children:[{type:"file",id:"browseFileButton",label:b.lang.ibmuploadimage.ibm.fileUpload,style:"display:none;",onChange:function(){this.getDialog().getContentElement("Upload","selectedFile").getInputElement().$.value=""!==this.getValue()?this.getValue():b.lang.ibmuploadimage.ibm.noFileChosen}},
{type:"fileButton",id:"uploadButton",filebrowser:{action:"QuickUpload",target:"info:txtUrl",url:null!=b.config.ibmUploadImage.uploadUrl&&""!=b.config.ibmUploadImage.uploadUrl?b.config.ibmUploadImage.uploadUrl:b.config.ibmBinaryImageUploadUrl},style:"display:none;",label:b.lang.ibmuploadimage.btnUpload,"for":["Upload","browseFileButton"]}]},{type:"hbox",padding:0,style:"height:300px;",widths:["20%","80%"],children:[{type:"button",id:"browseFile",label:b.lang.ibmuploadimage.ibm.browseFile,onLoad:function(){var a=
this.getDialog().getContentElement("Upload","fileUploadLabel");a&&this.getInputElement().setAttribute("aria-describedby",a.domId);this.getInputElement().setAttribute("class","cke_dialog_ui_primary_button");this.getInputElement().getChildren().getItem(0).setAttribute("class","cke_dialog_ui_primary_button")},onClick:function(){this.getDialog().getContentElement("Upload","browseFileButton").getInputElement().$.click()}},{type:"text",id:"selectedFile",label:b.lang.ibmuploadimage.ibm.file,labelStyle:"display:none",
style:"padding-left: 10px;",size:38,className:"cke_disabled",onLoad:function(){this.getInputElement().getParent().setStyle("border","none");this.getInputElement().getParent().setStyle("background","white");this.getInputElement().setStyle("background","white");this.setValue(b.lang.ibmuploadimage.ibm.noFileChosen);this.getInputElement().setAttribute("readOnly",!0);this.getElement().on("keydown",function(a){13==a.data.$.keyCode&&a.data.$.stopPropagation()},this.getDialog())},onShow:function(){""==this.getValue()&&
this.setValue(b.lang.ibmuploadimage.ibm.noFileChosen);this.getInputElement().setStyle("background","white");this.getInputElement().setAttribute("readOnly",!0)}}]}]}]},{id:"info",label:b.lang.ibmuploadimage.infoTab,accessKey:"I",elements:[{type:"vbox",padding:0,style:"margin:0; padding: 0; width:100%;",children:[{type:"html",id:"imageLinkLabel",style:"margin:0; padding: 0; width:100%;",html:"<div>"+CKEDITOR.tools.htmlEncode(b.lang.ibmuploadimage.ibm.imageLinkLabel)+"</div>"}]},{type:"hbox",padding:0,
children:[{id:"txtUrl2",type:"text",label:b.lang.ibmuploadimage.ibm.linkLabel,labelLayout:"horizontal",widths:["13%","87%"],style:"width:100%","default":"",onShow:function(){this.getElement().findOne("td").removeClass("cke_dialog_ui_hbox_first").setStyle("vertical-align","middle")},setup:function(a,c){if(2==a){var b=c.data("cke-saved-href");b||(b=c.getAttribute("href"));this.setValue(b)}},commit:function(a,c){if(2==a&&(this.getValue()||this.isChanged())){var d=this.getValue();c.data("cke-saved-href",
d);c.setAttribute("href",d);if(this.getValue()||!b.config.image_removeLinkByEmptyURL)this.getDialog().addLink=!0}}}]},{type:"hbox",padding:0,children:[{id:"cmbTarget",type:"select",style:"width:100%",requiredContent:"a[target]",label:b.lang.common.target,labelLayout:"horizontal",widths:["13%","87%"],"default":"",onShow:function(){this.getElement().findOne("td").removeClass("cke_dialog_ui_hbox_first").setStyle("vertical-align","middle")},items:[[b.lang.common.notSet,""],[b.lang.common.targetNew,"_blank"],
[b.lang.common.targetTop,"_top"],[b.lang.common.targetSelf,"_self"],[b.lang.common.targetParent,"_parent"]],setup:function(a,c){2==a&&this.setValue(c.getAttribute("target")||"")},commit:function(a,c){2==a&&(this.getValue()||this.isChanged())&&c.setAttribute("target",this.getValue())}}]},{type:"vbox",padding:0,widths:[20,80],children:[{type:"button",id:"browse",filebrowser:{action:"Browse",target:"Link:txtUrl",url:b.config.filebrowserImageBrowseLinkUrl},style:"float:right",hidden:!0,label:b.lang.common.browseServer},
{id:"txtUrl",type:"text",label:b.lang.common.url,required:!0,onChange:function(){var a=this.getDialog(),c=this.getValue();if(0<c.length){var a=this.getDialog(),b=a.originalElement;a.preview&&a.preview.removeStyle("display");b.setCustomData("isReady","false");var e=CKEDITOR.document.getById(q);e&&e.setStyle("display","");b.on("load",x,a);b.on("error",i,a);b.on("abort",i,a);b.setAttribute("src",c);a.preview&&(B.setAttribute("src",c),a.preview.setAttribute("src",B.$.src),m(a))}else a.preview&&(a.preview.removeAttribute("src"),
a.preview.setStyle("display","none"))},setup:function(a,c){if(a==f){var b=c.data("cke-saved-src")||c.getAttribute("src");this.getDialog().dontResetSize=!0;this.setValue(b);this.setInitValue()}},commit:function(a,c){a==f&&(this.getValue()||this.isChanged())?(c.data("cke-saved-src",this.getValue()),c.setAttribute("src",this.getValue())):8==a&&(c.setAttribute("src",""),c.removeAttribute("src"))},validate:CKEDITOR.dialog.validate.notEmpty(b.lang.ibmuploadimage.urlMissing)},{type:"button",id:"browse",
style:"display:inline-block;margin-top:14px;",align:"center",label:b.lang.common.browseServer,hidden:!0,filebrowser:"info:txtUrl"},{id:"txtAlt",type:"text",label:b.lang.ibmuploadimage.alt,accessKey:"T","default":"",onChange:function(){m(this.getDialog())},setup:function(a,c){a==f&&this.setValue(c.getAttribute("alt"))},commit:function(a,c){a==f?(this.getValue()||this.isChanged())&&c.setAttribute("alt",this.getValue()):4==a?c.setAttribute("alt",this.getValue()):8==a&&c.removeAttribute("alt")}},{type:"hbox",
requiredContent:"img{width,height}",children:[{type:"text",id:"txtWidth",label:b.lang.common.width,onKeyUp:E,onChange:function(){n.call(this,"advanced:txtdlgGenStyle")},validate:function(){var a=this.getValue().match(D);(a=!!(a&&0!==parseInt(a[1],10)))||alert(b.lang.common.invalidWidth);return a},setup:G,commit:function(a,c,d){var e=this.getValue();a==f?(e&&b.activeFilter.check("img{width,height}")?c.setStyle("width",CKEDITOR.tools.cssLength(e)):c.removeStyle("width"),!d&&c.removeAttribute("width")):
4==a?e.match(u)?c.setStyle("width",CKEDITOR.tools.cssLength(e)):(a=this.getDialog().originalElement,"true"==a.getCustomData("isReady")&&c.setStyle("width",a.$.width+"px")):8==a&&(c.removeAttribute("width"),c.removeStyle("width"))}},{type:"text",id:"txtHeight",label:b.lang.common.height,onKeyUp:E,onChange:function(){n.call(this,"advanced:txtdlgGenStyle")},validate:function(){var a=this.getValue().match(D);(a=!!(a&&0!==parseInt(a[1],10)))||alert(b.lang.common.invalidHeight);return a},setup:G,commit:function(a,
c,d){var e=this.getValue();a==f?(e&&b.activeFilter.check("img{width,height}")?c.setStyle("height",CKEDITOR.tools.cssLength(e)):c.removeStyle("height"),!d&&c.removeAttribute("height")):4==a?e.match(u)?c.setStyle("height",CKEDITOR.tools.cssLength(e)):(a=this.getDialog().originalElement,"true"==a.getCustomData("isReady")&&c.setStyle("height",a.$.height+"px")):8==a&&(c.removeAttribute("height"),c.removeStyle("height"))}}]},{type:"hbox",requiredContent:"img{width,height}",children:[{type:"text",id:"txtHSpace",
requiredContent:"img{margin-left,margin-right}",label:b.lang.ibmuploadimage.hSpace,"default":"",onKeyUp:function(){m(this.getDialog())},onChange:function(){n.call(this,"advanced:txtdlgGenStyle")},validate:CKEDITOR.dialog.validate.integer(b.lang.ibmuploadimage.validateHSpace),setup:function(a,c){if(a==f){var b,e;b=c.getStyle("margin-left");e=c.getStyle("margin-right");b=b&&b.match(v);e=e&&e.match(v);b=parseInt(b,10);e=parseInt(e,10);b=b==e&&b;isNaN(parseInt(b,10))&&(b=c.getAttribute("hspace"));this.setValue(b)}},
commit:function(a,c,b){var e=parseInt(this.getValue(),10);a==f||4==a?(isNaN(e)?!e&&this.isChanged()&&(c.removeStyle("margin-left"),c.removeStyle("margin-right")):(c.setStyle("margin-left",CKEDITOR.tools.cssLength(e)),c.setStyle("margin-right",CKEDITOR.tools.cssLength(e))),!b&&a==f&&c.removeAttribute("hspace")):8==a&&(c.removeAttribute("hspace"),c.removeStyle("margin-left"),c.removeStyle("margin-right"))}},{type:"text",id:"txtVSpace",requiredContent:"img{margin-top,margin-bottom}",label:b.lang.ibmuploadimage.vSpace,
"default":"",onKeyUp:function(){m(this.getDialog())},onChange:function(){n.call(this,"advanced:txtdlgGenStyle")},validate:CKEDITOR.dialog.validate.integer(b.lang.ibmuploadimage.validateVSpace),setup:function(a,c){if(a==f){var b,e;b=c.getStyle("margin-top");e=c.getStyle("margin-bottom");b=b&&b.match(v);e=e&&e.match(v);b=parseInt(b,10);e=parseInt(e,10);b=b==e&&b;isNaN(parseInt(b,10))&&(b=c.getAttribute("vspace"));this.setValue(b)}},commit:function(a,c,b){var e=parseInt(this.getValue(),10);a==f||4==
a?(isNaN(e)?!e&&this.isChanged()&&(c.removeStyle("margin-top"),c.removeStyle("margin-bottom")):(c.setStyle("margin-top",CKEDITOR.tools.cssLength(e)),c.setStyle("margin-bottom",CKEDITOR.tools.cssLength(e))),!b&&a==f&&c.removeAttribute("vspace")):8==a&&(c.removeAttribute("vspace"),c.removeStyle("margin-top"),c.removeStyle("margin-bottom"))}}]},{type:"hbox",requiredContent:"img{width,height}",children:[{id:"cmbAlign",requiredContent:"img{float}",type:"select",style:"width:100%",label:b.lang.common.align,
"default":"",items:[[b.lang.common.notSet,""],[b.lang.common.alignLeft,"left"],[b.lang.common.alignRight,"right"]],onChange:function(){m(this.getDialog());n.call(this,"advanced:txtdlgGenStyle")},setup:function(a,c){if(a==f){var b=c.getStyle("float");switch(b){case "inherit":case "none":b=""}!b&&(b=(c.getAttribute("align")||"").toLowerCase());this.setValue(b)}},commit:function(a,c,b){var e=this.getValue();if(a==f||4==a){if(e?c.setStyle("float",e):c.removeStyle("float"),!b&&a==f)switch(e=(c.getAttribute("align")||
"").toLowerCase(),e){case "left":case "right":c.removeAttribute("align")}}else 8==a&&c.removeStyle("float")}},{type:"text",id:"txtBorder",requiredContent:"img{border-width}",label:b.lang.ibmuploadimage.border,"default":"",onKeyUp:function(){m(this.getDialog())},onChange:function(){n.call(this,"advanced:txtdlgGenStyle")},validate:CKEDITOR.dialog.validate.integer(b.lang.ibmuploadimage.validateBorder),setup:function(a,c){if(a==f){var b;b=(b=(b=c.getStyle("border-width"))&&b.match(/^(\d+px)(?: \1 \1 \1)?$/))&&
parseInt(b[1],10);isNaN(parseInt(b,10))&&(b=c.getAttribute("border"));this.setValue(b)}},commit:function(a,b,d){var e=parseInt(this.getValue(),10);a==f||4==a?(isNaN(e)?!e&&this.isChanged()&&b.removeStyle("border"):(b.setStyle("border-width",CKEDITOR.tools.cssLength(e)),b.setStyle("border-style","solid")),!d&&a==f&&b.removeAttribute("border")):8==a&&(b.removeAttribute("border"),b.removeStyle("border-width"),b.removeStyle("border-style"),b.removeStyle("border-color"))}}]},{type:"hbox",widths:["5%",
"95%"],children:[{id:"ratioLock",type:"html",style:"margin-top:17px;width:"+(CKEDITOR.env.hc?"90px":"20px")+";height:50px;",onLoad:function(){var a=CKEDITOR.document.getById(C),b=CKEDITOR.document.getById(w);a&&(a.on("click",function(a){F(this);a.data&&a.data.preventDefault()},this.getDialog()),a.on("mouseover",function(){this.addClass("cke_btn_over")},a),a.on("mouseout",function(){this.removeClass("cke_btn_over")},a));b&&(b.on("click",function(a){p(this);var b=this.originalElement,c=this.getValueOf("info",
"txtWidth");if(b.getCustomData("isReady")=="true"&&c){b=b.$.height/b.$.width*c;if(!isNaN(b)){this.setValueOf("info","txtHeight",Math.round(b));m(this)}}a.data&&a.data.preventDefault()},this.getDialog()),b.on("mouseover",function(){this.addClass("cke_btn_over")},b),b.on("mouseout",function(){this.removeClass("cke_btn_over")},b))},html:'<div><a href="javascript:void(0)" tabindex="-1" title="'+b.lang.ibmuploadimage.lockRatio+'" class="cke_btn_locked" id="'+w+'" role="checkbox"><span class="cke_icon"></span><span class="cke_label">'+
b.lang.ibmuploadimage.lockRatio+'</span></a><a href="javascript:void(0)" tabindex="-1" title="'+b.lang.ibmuploadimage.resetSize+'" class="cke_btn_reset" id="'+C+'" role="button"><span class="cke_label">'+b.lang.ibmuploadimage.resetSize+"</span></a></div>"},{type:"html",id:"htmlPreview",style:"width:100%;",html:function(){for(var a="<div>"+CKEDITOR.tools.htmlEncode(b.lang.common.preview)+'<br><div id="'+q+'" class="ImagePreviewLoader" style="display:none"><div class="loading">&nbsp;</div></div><div class="ImagePreviewBox"><table><tr><td><a href="javascript:void(0)" target="_blank" onclick="return false;" id="'+
L+'"><img id="'+H+'" alt="" /></a>',c=0;15>c;c++)a+=b.lang.ibmuploadimage.ibm.previewText;return a+"</td></tr></table></div></div>"}()}]}]}]}],buttons:[{type:"hbox",id:"progressButton",children:[{id:"progress",type:"html",html:'<div style="float:left;padding-right: 60px;padding-top: 15px;" aria-live="polite" role="presentation"><img src="'+CKEDITOR.getUrl(CKEDITOR.plugins.get("ibmuploadimage").path+"images/loading.gif")+'" alt="'+b.lang.ibmuploadimage.ibm.inserting+'"> '+b.lang.ibmuploadimage.ibm.inserting+
"</div>",onLoad:function(){this.getElement().setStyle("visibility","hidden")}}]},{id:"ok",type:"button",label:b.lang.ibmuploadimage.ibm.insertButtonLabel,title:b.lang.ibmuploadimage.ibm.insertTitle,"class":"cke_dialog_ui_button_ok",onClick:function(a){var a=a.data.dialog,c=!0;a.getButton("progressButton").getChild(0).getElement();if("Upload"==a.definition.dialog._.currentTabId){if(c=O(a))a.imageEditMode||a.getButton("progressButton").getChild(0).getElement().setStyle("visibility","visible"),N(b,a,
M)}else!a.imageEditMode&&"Upload"==a.definition.dialog._.currentTabId&&a.getButton("progressButton").getChild(0).getElement().setStyle("visibility","visible"),!1!==a.fire("ok",{hide:!0}).hide&&(a.getButton("progressButton").getChild(0).getElement().setStyle("visibility","hidden"),a.hide())}},CKEDITOR.dialog.cancelButton]}};CKEDITOR.dialog.add("ibmuploadimage",function(b){return y(b,"image")});CKEDITOR.dialog.add("imagebutton",function(b){return y(b,"imagebutton")})})();