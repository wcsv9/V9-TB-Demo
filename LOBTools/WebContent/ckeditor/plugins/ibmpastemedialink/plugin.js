/* Copyright IBM Corp. 2009-2015  All Rights Reserved. */CKEDITOR.plugins.add("ibmpastemedialink",{icons:"ibmpastemedialink",requires:"embed",init:function(c){function f(a){CKEDITOR.env.webkit&&(a=a.replace(/\u200B/g,""));CKEDITOR.env.ie&&(a=a.replace(/\u00A0/g,""));e.lastIndex=0;return e.exec(a)}function g(a){if(f(a.data.dataValue)){var d=a.data.dataValue.replace("http://","").replace("https://","").replace("www.","").split(/[/?#]/)[0].split('"')[1];-1!=h.indexOf(d)&&(a=a.data.dataValue.split('href="')[1].split('">')[0],d=c.document.createElement("div"),
c.insertElement(d),c.widgets.initOn(d,"embed").loadContent(a,{noNotifications:!0,callback:function(){i.test(c.getData())&&setTimeout(function(){var a;for(a=c.getSelection().getRanges()[0].getPreviousNode();null!=a&&(a.getAttribute("class")&&-1==a.getAttribute("class").indexOf("cke_widget_wrapper cke_widget_block")||null==a.getAttribute("class"));)a=null==a.getPrevious()?a.getParent():a.getPrevious();var b=null;if(null!=a)for(b=a.getNext();null!=b&&"a"!=b.getName();)if("p"==b.getName()){for(b=b.getChildren().getItem(0);null!=
b.getNext()&&!(b.type!=CKEDITOR.NODE_TEXT&&"a"==b.getName());)b=b.getNext();if("a"==b.getName())break;else b=b.getParent().getNext()}else b=b.getNext();b.remove()})}}))}}var h=c.config.ibmPasteMediaLink.allowed_domains,i=/data-oembed-url/gi,e=RegExp("(^|\\s|>|&nbsp;*)(((https?|ftps?|news|mailto|notes):|www\\.|w3\\.)([\\w/\\#~:.?+=%@!\\[\\]\\-{},\\$\\*\\(\\);'\"]|(?:&|&amp;))+?)(?=[.:?\\),;!\\]'\"]*(?:[^\\w/\\#~:.?+=&%@!\\[\\]\\-{},\\$\\*\\(\\);'\"]|&nbsp;|$))","gi");c.on("paste",function(a){g(a)})}});