<?xml version="1.0" encoding="UTF-8"?>
<!--
 =================================================================
  Licensed Materials - Property of IBM

  WebSphere Commerce

  (C) Copyright IBM Corp. 2009, 2012 All Rights Reserved.

  US Government Users Restricted Rights - Use, duplication or
  disclosure restricted by GSA ADP Schedule Contract with
  IBM Corp.
 =================================================================
-->
<testcase>
	
	<!-- Open Marketing tool -->
	<action name="cmc/automation/AutoOpenToolAction">
		<param name="toolId" value="marketingManagement"/>
	</action>
	
	<!-- Select store -->
	<action name="cmc/automation/AutoSelectStoreAction">
		<param name="storeKey" value="storeIdentifier"/>
	</action>
	
	<!-- Create EMarketing Spot -->
	<!-- Create a new EMarketing Spot -->
	<action name="cmc/automation/AutoCreateNewObjectAction">
		<param name="objectType" value="EMarketingSpot"/>
		<param name="objectKey" value="eMarketingSpot"/>
	</action>
	
	<!-- Set EMarketing Spot Properties -->
	<!-- Set the name property -->
	<action name="cmc/automation/AutoSetPropertyAction">
		<param name="object" value="eMarketingSpot"/>
		<param name="propertyName" value="name"/>
		<param name="valueKey" value="eMarketingSpotNameCreate"/>
	</action>
	
	<!-- Set the description property -->
	<action name="cmc/automation/AutoSetPropertyAction">
		<param name="object" value="eMarketingSpot"/>
		<param name="propertyName" value="description"/>
		<param name="valueKey" value="eMarketingSpotDescriptionCreate"/>
	</action>
	
	<!-- Set the supportsMarketingContent property -->
	<action name="cmc/automation/AutoSetPropertyAction">
		<param name="object" value="eMarketingSpot"/>
		<param name="propertyName" value="supportsMarketingContent"/>
		<param name="valueKey" value="supportsMarketingContentCreate"/>
	</action>
	
	<!-- Set the supportsCatalogGroup property -->
	<action name="cmc/automation/AutoSetPropertyAction">
		<param name="object" value="eMarketingSpot"/>
		<param name="propertyName" value="supportsCatalogGroup"/>
		<param name="valueKey" value="supportsCatalogGroupCreate"/>
	</action>
	
	<!-- Set the supportsCatalogEntry property -->
	<action name="cmc/automation/AutoSetPropertyAction">
		<param name="object" value="eMarketingSpot"/>
		<param name="propertyName" value="supportsCatalogEntry"/>
		<param name="valueKey" value="supportsCatalogEntryCreate"/>
	</action>

	<!-- Set the supportsWidget property -->
	<action name="cmc/automation/AutoSetPropertyAction">
		<param name="object" value="eMarketingSpot"/>
		<param name="propertyName" value="supportsWidget"/>
		<param name="valueKey" value="supportsWidgetCreate"/>
	</action>
	
	<!-- Save all -->
	<action name="cmc/automation/AutoSaveAllAction"/>
	
	<!-- Refresh all -->
	<action name="cmc/automation/AutoRefreshAllAction"/>
	
	<!-- Test Create EMarketing Spot -->
	<!-- Find the EMarketing Spot -->
	<action name="cmc/automation/AutoFindObjectAction">
		<param name="searchType" value="FindEMarketingSpots"/>
		<param name="searchKey" value="eMarketingSpotNameCreate"/>
		<param name="objectKey" value="eMarketingSpot"/>
	</action>
	
	<!-- Verify that the EMarketing Spot was found -->
	<action name="cmc/automation/AutoVerifyObjectAction">
		<param name="object" value="eMarketingSpot"/>
	</action>
	
	<!-- Verify the name property of the EMarketing Spot -->
	<action name="cmc/automation/AutoVerifyPropertyAction">
		<param name="object" value="eMarketingSpot"/>
		<param name="propertyName" value="name"/>
		<param name="valueKey" value="eMarketingSpotNameCreate"/>
	</action>
	
	<!-- Verify the description property of the EMarketing Spot -->
	<action name="cmc/automation/AutoVerifyPropertyAction">
		<param name="object" value="eMarketingSpot"/>
		<param name="propertyName" value="description"/>
		<param name="valueKey" value="eMarketingSpotDescriptionCreate"/>
	</action>
	
	<!-- Verify the supportsMarketingContent property of the EMarketing Spot -->
	<action name="cmc/automation/AutoVerifyPropertyAction">
		<param name="object" value="eMarketingSpot"/>
		<param name="propertyName" value="supportsMarketingContent"/>
		<param name="valueKey" value="supportsMarketingContentCreate"/>
	</action>
	
	<!-- Verify the supportsCatalogGroup property of the EMarketing Spot -->
	<action name="cmc/automation/AutoVerifyPropertyAction">
		<param name="object" value="eMarketingSpot"/>
		<param name="propertyName" value="supportsCatalogGroup"/>
		<param name="valueKey" value="supportsCatalogGroupCreate"/>
	</action>
	
	<!-- Verify the supportsCatalogEntry property of the EMarketing Spot -->
	<action name="cmc/automation/AutoVerifyPropertyAction">
		<param name="object" value="eMarketingSpot"/>
		<param name="propertyName" value="supportsCatalogEntry"/>
		<param name="valueKey" value="supportsCatalogEntryCreate"/>
	</action>

	<!-- Verify the supportsWidget property of the EMarketing Spot -->
	<action name="cmc/automation/AutoVerifyPropertyAction">
		<param name="object" value="eMarketingSpot"/>
		<param name="propertyName" value="supportsWidget"/>
		<param name="valueKey" value="supportsWidgetCreate"/>
	</action>
	
	<!-- Modify EMarketing Spot -->
	<!-- Find the EMarketing Spot -->
	<action name="cmc/automation/AutoFindObjectAction">
		<param name="searchType" value="FindEMarketingSpots"/>
		<param name="searchKey" value="eMarketingSpotNameCreate"/>
		<param name="objectKey" value="eMarketingSpot"/>
	</action>
	
	<!-- Verify that the EMarketing Spot was found -->
	<action name="cmc/automation/AutoVerifyObjectAction">
		<param name="object" value="eMarketingSpot"/>
	</action>
	
	<!-- Set EMarketing Spot Properties -->
	<!-- Set the name property -->
	<action name="cmc/automation/AutoSetPropertyAction">
		<param name="object" value="eMarketingSpot"/>
		<param name="propertyName" value="name"/>
		<param name="valueKey" value="eMarketingSpotNameModify"/>
	</action>
	
	<!-- Set the description property -->
	<action name="cmc/automation/AutoSetPropertyAction">
		<param name="object" value="eMarketingSpot"/>
		<param name="propertyName" value="description"/>
		<param name="valueKey" value="eMarketingSpotDescriptionModify"/>
	</action>
	
	<!-- Set the supportsMarketingContent property -->
	<action name="cmc/automation/AutoSetPropertyAction">
		<param name="object" value="eMarketingSpot"/>
		<param name="propertyName" value="supportsMarketingContent"/>
		<param name="valueKey" value="supportsMarketingContentModify"/>
	</action>
	
	<!-- Set the supportsCatalogGroup property -->
	<action name="cmc/automation/AutoSetPropertyAction">
		<param name="object" value="eMarketingSpot"/>
		<param name="propertyName" value="supportsCatalogGroup"/>
		<param name="valueKey" value="supportsCatalogGroupModify"/>
	</action>
	
	<!-- Set the supportsCatalogEntry property -->
	<action name="cmc/automation/AutoSetPropertyAction">
		<param name="object" value="eMarketingSpot"/>
		<param name="propertyName" value="supportsCatalogEntry"/>
		<param name="valueKey" value="supportsCatalogEntryModify"/>
	</action>

	<!-- Set the supportsWidget property -->
	<action name="cmc/automation/AutoSetPropertyAction">
		<param name="object" value="eMarketingSpot"/>
		<param name="propertyName" value="supportsWidget"/>
		<param name="valueKey" value="supportsWidgetModify"/>
	</action>
	
	<!-- Save all -->
	<action name="cmc/automation/AutoSaveAllAction"/>
	
	<!-- Refresh all -->
	<action name="cmc/automation/AutoRefreshAllAction"/>
	
	<!-- Test Modify EMarketing Spot -->
	<!-- Find the EMarketing Spot -->
	<action name="cmc/automation/AutoFindObjectAction">
		<param name="searchType" value="FindEMarketingSpots"/>
		<param name="searchKey" value="eMarketingSpotNameModify"/>
		<param name="objectKey" value="eMarketingSpot"/>
	</action>
	
	<!-- Verify that the EMarketing Spot was found -->
	<action name="cmc/automation/AutoVerifyObjectAction">
		<param name="object" value="eMarketingSpot"/>
	</action>
	
	<!-- Verify the name property of the EMarketing Spot -->
	<action name="cmc/automation/AutoVerifyPropertyAction">
		<param name="object" value="eMarketingSpot"/>
		<param name="propertyName" value="name"/>
		<param name="valueKey" value="eMarketingSpotNameModify"/>
	</action>
	
	<!-- Verify the description property of the EMarketing Spot -->
	<action name="cmc/automation/AutoVerifyPropertyAction">
		<param name="object" value="eMarketingSpot"/>
		<param name="propertyName" value="description"/>
		<param name="valueKey" value="eMarketingSpotDescriptionModify"/>
	</action>
	
	<!-- Delete EMarketing Spot -->
	<action name="cmc/automation/AutoDeleteObjectAction">
		<param name="object" value="eMarketingSpot"/>
	</action>
	
	<!-- Save all -->
	<action name="cmc/automation/AutoSaveAllAction"/>
	
	<action name="cmc/automation/AutoFindObjectAction">
		<param name="searchType" value="FindEMarketingSpots"/>
		<param name="searchKey" value="eMarketingSpotNameModify"/>
		<param name="objectKey" value="eMarketingSpot"/>
	</action>
	
	<action name="cmc/automation/AutoVerifyNoObjectAction">
		<param name="object" value="eMarketingSpot"/>
	</action>
	
	<!-- Use create object action to create a new EMarketing Spot -->
	<action name="cmc/automation/AutoTriggerActionAction">
		<param name="actionHandler" value="cmc/foundation/CreateObjectActionHandler"/>
		<param name="stringOption.objectType" value="EMarketingSpot"/>
		<param name="stringOptionKey.newObjectOptions.marketingSpotName" value="eMarketingSpotNameCreate"/>
		<param name="stringOption.objectKey" value="eMarketingSpot"/>
	</action>
	
	<!-- Verify that the EMarketing Spot was created -->
	<action name="cmc/automation/AutoVerifyObjectAction">
		<param name="object" value="eMarketingSpot"/>
	</action>
	
	<!-- Verify the name property of the EMarketing Spot was set by the populate new object service -->
	<action name="cmc/automation/AutoVerifyPropertyAction">
		<param name="object" value="eMarketingSpot"/>
		<param name="propertyName" value="name"/>
		<param name="valueKey" value="eMarketingSpotNameCreate"/>
	</action>
	
	<!-- Save all -->
	<action name="cmc/automation/AutoSaveAllAction"/>
	
	<!-- Refresh all -->
	<action name="cmc/automation/AutoRefreshAllAction"/>
	
	<!-- Invoke open object action to re-open EMarketing Spot. -->
	<action name="cmc/automation/AutoTriggerActionAction">
		<param name="actionHandler" value="cmc/foundation/OpenObjectActionHandler"/>
		<param name="stringOption.searchType" value="FindEMarketingSpots"/>
		<param name="stringOptionKey.searchOptions.searchText" value="eMarketingSpotNameCreate"/>
		<param name="stringOption.objectKey" value="eMarketingSpot"/>
	</action>
	
	<!-- Verify that the EMarketing Spot was opened -->
	<action name="cmc/automation/AutoVerifyObjectAction">
		<param name="object" value="eMarketingSpot"/>
	</action>

	<!-- Delete EMarketing Spot -->
	<action name="cmc/automation/AutoDeleteObjectAction">
		<param name="object" value="eMarketingSpot"/>
	</action>

	<action name="cmc/automation/AutoVerifyNoObjectAction">
		<param name="object" value="eMarketingSpot"/>
	</action>

</testcase>