<?xml version="1.0" encoding="UTF-8"?>
<!--
 *===================================================================
 * Licensed Materials - Property of IBM
 *
 * WebSphere Commerce
 *
 * (c) Copyright International Business Machines Corporation. 2003
 *     All rights reserved.
 *
 * US Government Users Restricted Rights - Use, duplication or
 * disclosure restricted by GSA ADP Schedule Contract with IBM Corp.
 *===================================================================
-->
<Reporting>
	<Report reportName="biBAProductsLookedAtBySingleUserReportNumOfProdAdded" online="true" dataSourceName="WCA DataSource">
		<comment></comment>
		<SQLvalue>
SELECT  *
	FROM(
	SELECT 	FE.MEMBER_ID AS MEM_ID,
			COALESCE(M.FIRST_NAME,'') CONCAT (CASE WHEN M.FIRST_NAME IS NOT NULL AND M.MIDDLE_NAME IS NOT NULL THEN ' ' ELSE '' END CONCAT COALESCE(M.MIDDLE_NAME,'')) CONCAT ( CASE WHEN M.MIDDLE_NAME IS NOT NULL AND M.LAST_NAME IS NOT NULL THEN ' '  WHEN M.FIRST_NAME IS NOT NULL AND M.MIDDLE_NAME IS NULL AND M.LAST_NAME IS NOT NULL THEN ' ' ELSE '' END CONCAT  COALESCE(M.LAST_NAME,'') ) AS MEM_NAME,
			FE.PRODUCT_ID AS PR_ID,
			PREF.SHORT_DESCRIPTION,
			PRO.PARTNUM AS PARTNUM,
			COUNT(FE.PRODUCT_ID) AS COUNT
		FROM 
			WCA.FACT_EVENT FE,
			WCA.MEMBER M,
			WCA.PRODUCT PRO,
			WCA.PERIOD P,
			WCA.PRODUCT_REF PREF
		WHERE 
			M.MEMBER_ID = FE.MEMBER_ID
			AND PREF.LANGUAGE_ID IN (
			SELECT INTEGER (PR.PARAM_VALUE) 
			FROM WCA.PARAMETERS PR 
			WHERE PR.PARAM_TYPE='REPORT_LANGUAGE') 
			AND FE.STORE_ID IN ({storeent_id})
			AND FE.PRODUCT_ID = PRO.PRODUCT_ID
			AND PREF.PRODUCT_ID = FE.PRODUCT_ID
			AND FE.EVENT_TYPE_ID = 2
			AND FE.PER_ID = P.PER_ID
			AND P.CALENDAR_DATE &gt;= $DB_TIMESTAMP_FUNC({StartDate})$
 			AND P.CALENDAR_DATE &lt;= $DB_TIMESTAMP_FUNC({EndDate})$
		GROUP BY
			FE.MEMBER_ID,
			FE.PRODUCT_ID,
			PRO.PARTNUM,
			M.FIRST_NAME,
			M.MIDDLE_NAME,
			M.LAST_NAME,
			PREF.SHORT_DESCRIPTION) AS T1
	WHERE
		 (T1.MEM_ID,T1.COUNT) IN(
		SELECT DISTINCT MEM_ID,MAX(COUNT)
		FROM(
			SELECT COUNT(FE.PRODUCT_ID) AS COUNT ,
				FE.MEMBER_ID AS MEM_ID,
				FE.PRODUCT_ID AS PR_ID 
			FROM 
				WCA.FACT_EVENT FE,
				WCA.MEMBER M,
				WCA.PRODUCT PRO,
				WCA.PERIOD P,
				WCA.PRODUCT_REF PREF
			WHERE 
				M.MEMBER_ID = FE.MEMBER_ID
				AND PREF.LANGUAGE_ID IN (
				SELECT INTEGER (PR.PARAM_VALUE) 
				FROM WCA.PARAMETERS PR 
				WHERE PR.PARAM_TYPE='REPORT_LANGUAGE') 
				AND FE.STORE_ID IN ({storeent_id})
				AND FE.PRODUCT_ID = PRO.PRODUCT_ID
				AND PREF.PRODUCT_ID = FE.PRODUCT_ID
				AND FE.EVENT_TYPE_ID = 2
				AND FE.PER_ID = P.PER_ID
				AND P.CALENDAR_DATE = (Current date -1 Days)
			GROUP BY
				FE.MEMBER_ID,
				FE.PRODUCT_ID
			) AS COUNT_TABLE
		GROUP BY MEM_ID
		)
		Order By COUNT DESC
		</SQLvalue>
		<display>
			<standardInfo>
				<resourceBundle>bi.biNLS</resourceBundle>
				<title>BAProductsLookedAtBySingleUser</title>
				<message>BAProductsLookedAtBySingleUser</message>
			</standardInfo>
			<userDefinedParameters>
				<THStyle>TH { font-family : Times New Roman, Times, serif; font-size : 10pt; color : #565665; font-weight : bold; }</THStyle>
				<TDStyle>TD { font-family : Verdana,  Arial, Helvetica; font-size : 9pt; color : Black; }</TDStyle>
				<spaceBetweenColumns>25</spaceBetweenColumns>
				<columnDefaultAttributes>
					<displayInReport>true</displayInReport>
					<columnWidth>0</columnWidth>
					<maxEntryLength>999</maxEntryLength>
					<columnType>string</columnType>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columnDefaultAttributes>
				<columns>
					<columnKey>C0</columnKey>
					<columnName>userId</columnName>
					<columnOptions>ALIGN=RIGHT HEIGHT=20 NOWRAP</columnOptions>
					<columnType>integer</columnType>
				</columns>
				<columns>
					<columnKey>C1</columnKey>
					<columnName>userName</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C2</columnKey>
					<columnName>partNum</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C3</columnKey>
					<columnName>prodName</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C4</columnKey>
					<columnName>prodDescrip</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C5</columnKey>
					<columnName>numOfProdViewed</columnName>
					<columnOptions>ALIGN=RIGHT HEIGHT=20 NOWRAP</columnOptions>
					<columnType>integer</columnType>					
				</columns>
			</userDefinedParameters>
		</display>
	</Report>
	<Report reportName="biBAProductsLookedAtBySingleUserReportYesterdayNumOfProdAdded" online="true" dataSourceName="WCA DataSource">
		<comment></comment>
		<SQLvalue>
SELECT  *
	FROM(
	SELECT 	FE.MEMBER_ID AS MEM_ID,
			COALESCE(M.FIRST_NAME,'') CONCAT (CASE WHEN M.FIRST_NAME IS NOT NULL AND M.MIDDLE_NAME IS NOT NULL THEN ' ' ELSE '' END CONCAT COALESCE(M.MIDDLE_NAME,'')) CONCAT ( CASE WHEN M.MIDDLE_NAME IS NOT NULL AND M.LAST_NAME IS NOT NULL THEN ' '  WHEN M.FIRST_NAME IS NOT NULL AND M.MIDDLE_NAME IS NULL AND M.LAST_NAME IS NOT NULL THEN ' ' ELSE '' END CONCAT  COALESCE(M.LAST_NAME,'') ) AS MEM_NAME,
			FE.PRODUCT_ID AS PR_ID,
			PREF.SHORT_DESCRIPTION,
			PRO.PARTNUM AS PARTNUM,
			COUNT(FE.PRODUCT_ID) AS COUNT
		FROM 
			WCA.FACT_EVENT FE,
			WCA.MEMBER M,
			WCA.PRODUCT PRO,
			WCA.PERIOD P,
			WCA.PRODUCT_REF PREF
		WHERE 
			M.MEMBER_ID = FE.MEMBER_ID
			AND PREF.LANGUAGE_ID IN (
			SELECT INTEGER (PR.PARAM_VALUE) 
			FROM WCA.PARAMETERS PR 
			WHERE PR.PARAM_TYPE='REPORT_LANGUAGE') 
			AND FE.STORE_ID IN ({storeent_id})
			AND FE.PRODUCT_ID = PRO.PRODUCT_ID
			AND PREF.PRODUCT_ID = FE.PRODUCT_ID
			AND FE.EVENT_TYPE_ID = 2
			AND FE.PER_ID = P.PER_ID
			AND P.CALENDAR_DATE = (Current date -1 Days)
		GROUP BY
			FE.MEMBER_ID,
			FE.PRODUCT_ID,
			PRO.PARTNUM,
			M.FIRST_NAME,
			M.MIDDLE_NAME,
			M.LAST_NAME,
			PREF.SHORT_DESCRIPTION) AS T1
	WHERE
		 (T1.MEM_ID,T1.COUNT) IN(
		SELECT DISTINCT MEM_ID,MAX(COUNT)
		FROM(
			SELECT COUNT(FE.PRODUCT_ID) AS COUNT ,
				FE.MEMBER_ID AS MEM_ID,
				FE.PRODUCT_ID AS PR_ID 
			FROM 
				WCA.FACT_EVENT FE,
				WCA.MEMBER M,
				WCA.PRODUCT PRO,
				WCA.PERIOD P,
				WCA.PRODUCT_REF PREF
			WHERE 
				M.MEMBER_ID = FE.MEMBER_ID
				AND PREF.LANGUAGE_ID IN (
				SELECT INTEGER (PR.PARAM_VALUE) 
				FROM WCA.PARAMETERS PR 
				WHERE PR.PARAM_TYPE='REPORT_LANGUAGE') 
				AND FE.STORE_ID IN ({storeent_id})
				AND FE.PRODUCT_ID = PRO.PRODUCT_ID
				AND PREF.PRODUCT_ID = FE.PRODUCT_ID
				AND FE.EVENT_TYPE_ID = 2
				AND FE.PER_ID = P.PER_ID
				AND P.CALENDAR_DATE = (Current date -1 Days)
			GROUP BY
				FE.MEMBER_ID,
				FE.PRODUCT_ID
			) AS COUNT_TABLE
		GROUP BY
			MEM_ID
			) Order By COUNT DESC
		</SQLvalue>
		<display>
			<standardInfo>
				<resourceBundle>bi.biNLS</resourceBundle>
				<title>BAProductsLookedAtBySingleUser</title>
				<message>BAProductsLookedAtBySingleUser</message>
			</standardInfo>
			<userDefinedParameters>
				<THStyle>TH { font-family : Times New Roman, Times, serif; font-size : 10pt; color : #565665; font-weight : bold; }</THStyle>
				<TDStyle>TD { font-family : Verdana,  Arial, Helvetica; font-size : 9pt; color : Black; }</TDStyle>
				<spaceBetweenColumns>25</spaceBetweenColumns>
				<columnDefaultAttributes>
					<displayInReport>true</displayInReport>
					<columnWidth>0</columnWidth>
					<maxEntryLength>999</maxEntryLength>
					<columnType>string</columnType>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columnDefaultAttributes>
				<columns>
					<columnKey>C0</columnKey>
					<columnName>userId</columnName>
					<columnOptions>ALIGN=RIGHT HEIGHT=20 NOWRAP</columnOptions>
					<columnType>integer</columnType>
				</columns>
				<columns>
					<columnKey>C1</columnKey>
					<columnName>userName</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C2</columnKey>
					<columnName>partNum</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C3</columnKey>
					<columnName>prodName</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C4</columnKey>
					<columnName>prodDescrip</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C5</columnKey>
					<columnName>numOfProdViewed</columnName>
					<columnOptions>ALIGN=RIGHT HEIGHT=20 NOWRAP</columnOptions>
					<columnType>integer</columnType>					
				</columns>
			</userDefinedParameters>
		</display>
	</Report>
	<Report reportName="biBAProductsLookedAtBySingleUserReportWeeklyNumOfProdAdded" online="true" dataSourceName="WCA DataSource">
		<comment></comment>
		<SQLvalue>
SELECT  *
	FROM(
	SELECT 	FE.MEMBER_ID AS MEM_ID,
			COALESCE(M.FIRST_NAME,'') CONCAT (CASE WHEN M.FIRST_NAME IS NOT NULL AND M.MIDDLE_NAME IS NOT NULL THEN ' ' ELSE '' END CONCAT COALESCE(M.MIDDLE_NAME,'')) CONCAT ( CASE WHEN M.MIDDLE_NAME IS NOT NULL AND M.LAST_NAME IS NOT NULL THEN ' '  WHEN M.FIRST_NAME IS NOT NULL AND M.MIDDLE_NAME IS NULL AND M.LAST_NAME IS NOT NULL THEN ' ' ELSE '' END CONCAT  COALESCE(M.LAST_NAME,'') ) AS MEM_NAME,
			FE.PRODUCT_ID AS PR_ID,
			PREF.SHORT_DESCRIPTION,
			PRO.PARTNUM AS PARTNUM,
			COUNT(FE.PRODUCT_ID) AS COUNT
		FROM 
			WCA.FACT_EVENT FE,
			WCA.MEMBER M,
			WCA.PRODUCT PRO,
			WCA.PERIOD P,
			WCA.PRODUCT_REF PREF
		WHERE 
			M.MEMBER_ID = FE.MEMBER_ID
			AND PREF.LANGUAGE_ID IN (
			SELECT INTEGER (PR.PARAM_VALUE) 
			FROM WCA.PARAMETERS PR 
			WHERE PR.PARAM_TYPE='REPORT_LANGUAGE') 
			AND FE.STORE_ID IN ({storeent_id})
			AND FE.PRODUCT_ID = PRO.PRODUCT_ID
			AND PREF.PRODUCT_ID = FE.PRODUCT_ID
			AND FE.EVENT_TYPE_ID = 2
			AND FE.PER_ID = P.PER_ID
						AND 
				(P.WK_OF_FY, FISCAL_YR) IN (
				SELECT
					WK_OF_FY,
					FISCAL_YR
				FROM
					WCA.PERIOD P
				WHERE
					P.CALENDAR_DATE=CURRENT DATE)

		GROUP BY
			FE.MEMBER_ID,
			FE.PRODUCT_ID,
			PRO.PARTNUM,
			M.FIRST_NAME,
			M.MIDDLE_NAME,
			M.LAST_NAME,
			PREF.SHORT_DESCRIPTION) AS T1
	WHERE
		 (T1.MEM_ID,T1.COUNT) IN(
		SELECT DISTINCT MEM_ID,MAX(COUNT)
		FROM(
			SELECT COUNT(FE.PRODUCT_ID) AS COUNT ,
				FE.MEMBER_ID AS MEM_ID,
				FE.PRODUCT_ID AS PR_ID 
			FROM 
				WCA.FACT_EVENT FE,
				WCA.MEMBER M,
				WCA.PRODUCT PRO,
				WCA.PERIOD P,
				WCA.PRODUCT_REF PREF
			WHERE 
				M.MEMBER_ID = FE.MEMBER_ID
				AND PREF.LANGUAGE_ID IN (
				SELECT INTEGER (PR.PARAM_VALUE) 
				FROM WCA.PARAMETERS PR 
				WHERE PR.PARAM_TYPE='REPORT_LANGUAGE') 
				AND FE.STORE_ID IN ({storeent_id})
				AND FE.PRODUCT_ID = PRO.PRODUCT_ID
				AND PREF.PRODUCT_ID = FE.PRODUCT_ID
				AND FE.EVENT_TYPE_ID = 2
				AND FE.PER_ID = P.PER_ID
							AND 
				(P.WK_OF_FY, FISCAL_YR) IN (
				SELECT
					WK_OF_FY,
					FISCAL_YR
				FROM
					WCA.PERIOD P
				WHERE
					P.CALENDAR_DATE=CURRENT DATE)

			GROUP BY
				FE.MEMBER_ID,
				FE.PRODUCT_ID
			) AS COUNT_TABLE
		GROUP BY
			MEM_ID
			) Order By COUNT DESC
		</SQLvalue>
		<display>
			<standardInfo>
				<resourceBundle>bi.biNLS</resourceBundle>
				<title>BAProductsLookedAtBySingleUser</title>
				<message>BAProductsLookedAtBySingleUser</message>
			</standardInfo>
			<userDefinedParameters>
				<THStyle>TH { font-family : Times New Roman, Times, serif; font-size : 10pt; color : #565665; font-weight : bold; }</THStyle>
				<TDStyle>TD { font-family : Verdana,  Arial, Helvetica; font-size : 9pt; color : Black; }</TDStyle>
				<spaceBetweenColumns>25</spaceBetweenColumns>
				<columnDefaultAttributes>
					<displayInReport>true</displayInReport>
					<columnWidth>0</columnWidth>
					<maxEntryLength>999</maxEntryLength>
					<columnType>string</columnType>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columnDefaultAttributes>
				<columns>
					<columnKey>C0</columnKey>
					<columnName>userId</columnName>
					<columnOptions>ALIGN=RIGHT HEIGHT=20 NOWRAP</columnOptions>
					<columnType>integer</columnType>
				</columns>
				<columns>
					<columnKey>C1</columnKey>
					<columnName>userName</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C2</columnKey>
					<columnName>partNum</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C3</columnKey>
					<columnName>prodName</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C4</columnKey>
					<columnName>prodDescrip</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C5</columnKey>
					<columnName>numOfProdViewed</columnName>
					<columnOptions>ALIGN=RIGHT HEIGHT=20 NOWRAP</columnOptions>
					<columnType>integer</columnType>					
				</columns>
			</userDefinedParameters>
		</display>
	</Report>
	<Report reportName="biBAProductsLookedAtBySingleUserReportMonthlyNumOfProdAdded" online="true" dataSourceName="WCA DataSource">
		<comment></comment>
		<SQLvalue>
SELECT  *
	FROM(
	SELECT 	FE.MEMBER_ID AS MEM_ID,
			COALESCE(M.FIRST_NAME,'') CONCAT (CASE WHEN M.FIRST_NAME IS NOT NULL AND M.MIDDLE_NAME IS NOT NULL THEN ' ' ELSE '' END CONCAT COALESCE(M.MIDDLE_NAME,'')) CONCAT ( CASE WHEN M.MIDDLE_NAME IS NOT NULL AND M.LAST_NAME IS NOT NULL THEN ' '  WHEN M.FIRST_NAME IS NOT NULL AND M.MIDDLE_NAME IS NULL AND M.LAST_NAME IS NOT NULL THEN ' ' ELSE '' END CONCAT  COALESCE(M.LAST_NAME,'') ) AS MEM_NAME,
			FE.PRODUCT_ID AS PR_ID,
			PREF.SHORT_DESCRIPTION,
			PRO.PARTNUM AS PARTNUM,
			COUNT(FE.PRODUCT_ID) AS COUNT
		FROM 
			WCA.FACT_EVENT FE,
			WCA.MEMBER M,
			WCA.PRODUCT PRO,
			WCA.PERIOD P,
			WCA.PRODUCT_REF PREF
		WHERE 
			M.MEMBER_ID = FE.MEMBER_ID
			AND PREF.LANGUAGE_ID IN (
			SELECT INTEGER (PR.PARAM_VALUE) 
			FROM WCA.PARAMETERS PR 
			WHERE PR.PARAM_TYPE='REPORT_LANGUAGE') 
			AND FE.STORE_ID IN ({storeent_id})
			AND FE.PRODUCT_ID = PRO.PRODUCT_ID
			AND PREF.PRODUCT_ID = FE.PRODUCT_ID
			AND FE.EVENT_TYPE_ID = 2
			AND FE.PER_ID = P.PER_ID
			AND (P.MON_OF_FY, FISCAL_YR) IN (
			SELECT
				MON_OF_FY,
				FISCAL_YR
			FROM
				WCA.PERIOD P
			WHERE
				P.CALENDAR_DATE=CURRENT DATE)

		GROUP BY
			FE.MEMBER_ID,
			FE.PRODUCT_ID,
			PRO.PARTNUM,
			M.FIRST_NAME,
			M.MIDDLE_NAME,
			M.LAST_NAME,
			PREF.SHORT_DESCRIPTION) AS T1
	WHERE
		 (T1.MEM_ID,T1.COUNT) IN(
		SELECT DISTINCT MEM_ID,MAX(COUNT)
		FROM(
			SELECT COUNT(FE.PRODUCT_ID) AS COUNT ,
				FE.MEMBER_ID AS MEM_ID,
				FE.PRODUCT_ID AS PR_ID 
			FROM 
				WCA.FACT_EVENT FE,
				WCA.MEMBER M,
				WCA.PRODUCT PRO,
				WCA.PERIOD P,
				WCA.PRODUCT_REF PREF
			WHERE 
				M.MEMBER_ID = FE.MEMBER_ID
				AND PREF.LANGUAGE_ID IN (
				SELECT INTEGER (PR.PARAM_VALUE) 
				FROM WCA.PARAMETERS PR 
				WHERE PR.PARAM_TYPE='REPORT_LANGUAGE') 
				AND FE.STORE_ID IN ({storeent_id})
				AND FE.PRODUCT_ID = PRO.PRODUCT_ID
				AND PREF.PRODUCT_ID = FE.PRODUCT_ID
				AND FE.EVENT_TYPE_ID = 2
				AND FE.PER_ID = P.PER_ID
				AND 
				(P.MON_OF_FY, FISCAL_YR) IN (
				SELECT
					MON_OF_FY,
					FISCAL_YR
				FROM
					WCA.PERIOD P
				WHERE
					P.CALENDAR_DATE=CURRENT DATE)

			GROUP BY
				FE.MEMBER_ID,
				FE.PRODUCT_ID
			) AS COUNT_TABLE
		GROUP BY
			MEM_ID
			) Order By COUNT DESC
		</SQLvalue>
		<display>
			<standardInfo>
				<resourceBundle>bi.biNLS</resourceBundle>
				<title>BAProductsLookedAtBySingleUser</title>
				<message>BAProductsLookedAtBySingleUser</message>
			</standardInfo>
			<userDefinedParameters>
				<THStyle>TH { font-family : Times New Roman, Times, serif; font-size : 10pt; color : #565665; font-weight : bold; }</THStyle>
				<TDStyle>TD { font-family : Verdana,  Arial, Helvetica; font-size : 9pt; color : Black; }</TDStyle>
				<spaceBetweenColumns>25</spaceBetweenColumns>
				<columnDefaultAttributes>
					<displayInReport>true</displayInReport>
					<columnWidth>0</columnWidth>
					<maxEntryLength>999</maxEntryLength>
					<columnType>string</columnType>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columnDefaultAttributes>
				<columns>
					<columnKey>C0</columnKey>
					<columnName>userId</columnName>
					<columnOptions>ALIGN=RIGHT HEIGHT=20 NOWRAP</columnOptions>
					<columnType>integer</columnType>
				</columns>
				<columns>
					<columnKey>C1</columnKey>
					<columnName>userName</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C2</columnKey>
					<columnName>partNum</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C3</columnKey>
					<columnName>prodName</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C4</columnKey>
					<columnName>prodDescrip</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C5</columnKey>
					<columnName>numOfProdViewed</columnName>
					<columnOptions>ALIGN=RIGHT HEIGHT=20 NOWRAP</columnOptions>
					<columnType>integer</columnType>					
				</columns>
			</userDefinedParameters>
		</display>
	</Report>
		<Report reportName="biBAProductsLookedAtBySingleUserReportQuarterlyNumOfProdAdded" online="true" dataSourceName="WCA DataSource">
		<comment></comment>
		<SQLvalue>
SELECT  *
	FROM(
	SELECT 	FE.MEMBER_ID AS MEM_ID,
			COALESCE(M.FIRST_NAME,'') CONCAT (CASE WHEN M.FIRST_NAME IS NOT NULL AND M.MIDDLE_NAME IS NOT NULL THEN ' ' ELSE '' END CONCAT COALESCE(M.MIDDLE_NAME,'')) CONCAT ( CASE WHEN M.MIDDLE_NAME IS NOT NULL AND M.LAST_NAME IS NOT NULL THEN ' '  WHEN M.FIRST_NAME IS NOT NULL AND M.MIDDLE_NAME IS NULL AND M.LAST_NAME IS NOT NULL THEN ' ' ELSE '' END CONCAT  COALESCE(M.LAST_NAME,'') ) AS MEM_NAME,
			FE.PRODUCT_ID AS PR_ID,
			PREF.SHORT_DESCRIPTION,
			PRO.PARTNUM AS PARTNUM,
			COUNT(FE.PRODUCT_ID) AS COUNT
		FROM 
			WCA.FACT_EVENT FE,
			WCA.MEMBER M,
			WCA.PRODUCT PRO,
			WCA.PERIOD P,
			WCA.PRODUCT_REF PREF
		WHERE 
			M.MEMBER_ID = FE.MEMBER_ID
			AND PREF.LANGUAGE_ID IN (
			SELECT INTEGER (PR.PARAM_VALUE) 
			FROM WCA.PARAMETERS PR 
			WHERE PR.PARAM_TYPE='REPORT_LANGUAGE') 
			AND FE.STORE_ID IN ({storeent_id})
			AND FE.PRODUCT_ID = PRO.PRODUCT_ID
			AND PREF.PRODUCT_ID = FE.PRODUCT_ID
			AND FE.EVENT_TYPE_ID = 2
			AND FE.PER_ID = P.PER_ID
			AND (P.QTR_OF_FY, FISCAL_YR) IN (
				SELECT
					QTR_OF_FY,
					FISCAL_YR
				FROM
					WCA.PERIOD P
				WHERE
					P.CALENDAR_DATE=CURRENT DATE)
		GROUP BY
			FE.MEMBER_ID,
			FE.PRODUCT_ID,
			PRO.PARTNUM,
			M.FIRST_NAME,
			M.MIDDLE_NAME,
			M.LAST_NAME,
			PREF.SHORT_DESCRIPTION) AS T1
	WHERE
		 (T1.MEM_ID,T1.COUNT) IN(
		SELECT DISTINCT MEM_ID,MAX(COUNT)
		FROM(
			SELECT COUNT(FE.PRODUCT_ID) AS COUNT ,
				FE.MEMBER_ID AS MEM_ID,
				FE.PRODUCT_ID AS PR_ID 
			FROM 
				WCA.FACT_EVENT FE,
				WCA.MEMBER M,
				WCA.PRODUCT PRO,
				WCA.PERIOD P,
				WCA.PRODUCT_REF PREF
			WHERE 
				M.MEMBER_ID = FE.MEMBER_ID
				AND PREF.LANGUAGE_ID IN (
				SELECT INTEGER (PR.PARAM_VALUE) 
				FROM WCA.PARAMETERS PR 
				WHERE PR.PARAM_TYPE='REPORT_LANGUAGE') 
				AND FE.STORE_ID IN ({storeent_id})
				AND FE.PRODUCT_ID = PRO.PRODUCT_ID
				AND PREF.PRODUCT_ID = FE.PRODUCT_ID
				AND FE.EVENT_TYPE_ID = 2
				AND FE.PER_ID = P.PER_ID
				AND (P.QTR_OF_FY, FISCAL_YR) IN (
				SELECT
					QTR_OF_FY,
					FISCAL_YR
				FROM
					WCA.PERIOD P
				WHERE
					P.CALENDAR_DATE=CURRENT DATE)
			GROUP BY
				FE.MEMBER_ID,
				FE.PRODUCT_ID
			) AS COUNT_TABLE
		GROUP BY
			MEM_ID
			) Order By COUNT DESC
		</SQLvalue>
		<display>
			<standardInfo>
				<resourceBundle>bi.biNLS</resourceBundle>
				<title>BAProductsLookedAtBySingleUser</title>
				<message>BAProductsLookedAtBySingleUser</message>
			</standardInfo>
			<userDefinedParameters>
				<THStyle>TH { font-family : Times New Roman, Times, serif; font-size : 10pt; color : #565665; font-weight : bold; }</THStyle>
				<TDStyle>TD { font-family : Verdana,  Arial, Helvetica; font-size : 9pt; color : Black; }</TDStyle>
				<spaceBetweenColumns>25</spaceBetweenColumns>
				<columnDefaultAttributes>
					<displayInReport>true</displayInReport>
					<columnWidth>0</columnWidth>
					<maxEntryLength>999</maxEntryLength>
					<columnType>string</columnType>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columnDefaultAttributes>
				<columns>
					<columnKey>C0</columnKey>
					<columnName>userId</columnName>
					<columnOptions>ALIGN=RIGHT HEIGHT=20 NOWRAP</columnOptions>
					<columnType>integer</columnType>
				</columns>
				<columns>
					<columnKey>C1</columnKey>
					<columnName>userName</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C2</columnKey>
					<columnName>partNum</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C3</columnKey>
					<columnName>prodName</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C4</columnKey>
					<columnName>prodDescrip</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C5</columnKey>
					<columnName>numOfProdViewed</columnName>
					<columnOptions>ALIGN=RIGHT HEIGHT=20 NOWRAP</columnOptions>
					<columnType>integer</columnType>					
				</columns>
			</userDefinedParameters>
		</display>
	</Report>
	<Report reportName="biBAProductsLookedAtBySingleUserReportYearlyNumOfProdAdded" online="true" dataSourceName="WCA DataSource">
		<comment></comment>
		<SQLvalue>
SELECT  *
	FROM(
	SELECT 	FE.MEMBER_ID AS MEM_ID,
			COALESCE(M.FIRST_NAME,'') CONCAT (CASE WHEN M.FIRST_NAME IS NOT NULL AND M.MIDDLE_NAME IS NOT NULL THEN ' ' ELSE '' END CONCAT COALESCE(M.MIDDLE_NAME,'')) CONCAT ( CASE WHEN M.MIDDLE_NAME IS NOT NULL AND M.LAST_NAME IS NOT NULL THEN ' '  WHEN M.FIRST_NAME IS NOT NULL AND M.MIDDLE_NAME IS NULL AND M.LAST_NAME IS NOT NULL THEN ' ' ELSE '' END CONCAT  COALESCE(M.LAST_NAME,'') ) AS MEM_NAME,
			FE.PRODUCT_ID AS PR_ID,
			PREF.SHORT_DESCRIPTION,
			PRO.PARTNUM AS PARTNUM,
			COUNT(FE.PRODUCT_ID) AS COUNT
		FROM 
			WCA.FACT_EVENT FE,
			WCA.MEMBER M,
			WCA.PRODUCT PRO,
			WCA.PERIOD P,
			WCA.PRODUCT_REF PREF
		WHERE 
			M.MEMBER_ID = FE.MEMBER_ID
			AND PREF.LANGUAGE_ID IN (
			SELECT INTEGER (PR.PARAM_VALUE) 
			FROM WCA.PARAMETERS PR 
			WHERE PR.PARAM_TYPE='REPORT_LANGUAGE') 
			AND FE.STORE_ID IN ({storeent_id})
			AND FE.PRODUCT_ID = PRO.PRODUCT_ID
			AND PREF.PRODUCT_ID = FE.PRODUCT_ID
			AND FE.EVENT_TYPE_ID = 2
			AND FE.PER_ID = P.PER_ID
			AND P.FISCAL_YR = (
			SELECT
				FISCAL_YR
			FROM
				WCA.PERIOD
			WHERE
				CALENDAR_DATE=CURRENT DATE)

		GROUP BY
			FE.MEMBER_ID,
			FE.PRODUCT_ID,
			PRO.PARTNUM,
			M.FIRST_NAME,
			M.MIDDLE_NAME,
			M.LAST_NAME,
			PREF.SHORT_DESCRIPTION) AS T1
	WHERE
		 (T1.MEM_ID,T1.COUNT) IN(
		SELECT DISTINCT MEM_ID,MAX(COUNT)
		FROM(
			SELECT COUNT(FE.PRODUCT_ID) AS COUNT ,
				FE.MEMBER_ID AS MEM_ID,
				FE.PRODUCT_ID AS PR_ID 
			FROM 
				WCA.FACT_EVENT FE,
				WCA.MEMBER M,
				WCA.PRODUCT PRO,
				WCA.PERIOD P,
				WCA.PRODUCT_REF PREF
			WHERE 
				M.MEMBER_ID = FE.MEMBER_ID
				AND PREF.LANGUAGE_ID IN (
				SELECT INTEGER (PR.PARAM_VALUE) 
				FROM WCA.PARAMETERS PR 
				WHERE PR.PARAM_TYPE='REPORT_LANGUAGE') 
				AND FE.STORE_ID IN ({storeent_id})
				AND FE.PRODUCT_ID = PRO.PRODUCT_ID
				AND PREF.PRODUCT_ID = FE.PRODUCT_ID
				AND FE.EVENT_TYPE_ID = 2
				AND FE.PER_ID = P.PER_ID
					AND P.FISCAL_YR = (
				SELECT
					FISCAL_YR
				FROM
					WCA.PERIOD
				WHERE
					CALENDAR_DATE=CURRENT DATE)

			GROUP BY
				FE.MEMBER_ID,
				FE.PRODUCT_ID
			) AS COUNT_TABLE
		GROUP BY
			MEM_ID
			) Order By COUNT DESC
		</SQLvalue>
		<display>
			<standardInfo>
				<resourceBundle>bi.biNLS</resourceBundle>
				<title>BAProductsLookedAtBySingleUser</title>
				<message>BAProductsLookedAtBySingleUser</message>
			</standardInfo>
			<userDefinedParameters>
				<THStyle>TH { font-family : Times New Roman, Times, serif; font-size : 10pt; color : #565665; font-weight : bold; }</THStyle>
				<TDStyle>TD { font-family : Verdana,  Arial, Helvetica; font-size : 9pt; color : Black; }</TDStyle>
				<spaceBetweenColumns>25</spaceBetweenColumns>
				<columnDefaultAttributes>
					<displayInReport>true</displayInReport>
					<columnWidth>0</columnWidth>
					<maxEntryLength>999</maxEntryLength>
					<columnType>string</columnType>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columnDefaultAttributes>
				<columns>
					<columnKey>C0</columnKey>
					<columnName>userId</columnName>
					<columnOptions>ALIGN=RIGHT HEIGHT=20 NOWRAP</columnOptions>
					<columnType>integer</columnType>
				</columns>
				<columns>
					<columnKey>C1</columnKey>
					<columnName>userName</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C2</columnKey>
					<columnName>partNum</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C3</columnKey>
					<columnName>prodName</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C4</columnKey>
					<columnName>prodDescrip</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C5</columnKey>
					<columnName>numOfProdViewed</columnName>
					<columnOptions>ALIGN=RIGHT HEIGHT=20 NOWRAP</columnOptions>
					<columnType>integer</columnType>					
				</columns>
			</userDefinedParameters>
		</display>
	</Report>
	<Report reportName="biBAProductsLookedAtBySingleUserReportNumOfProdAddedAscend" online="true" dataSourceName="WCA DataSource">
		<comment></comment>
		<SQLvalue>
SELECT  *
	FROM(
	SELECT 	FE.MEMBER_ID AS MEM_ID,
			COALESCE(M.FIRST_NAME,'') CONCAT (CASE WHEN M.FIRST_NAME IS NOT NULL AND M.MIDDLE_NAME IS NOT NULL THEN ' ' ELSE '' END CONCAT COALESCE(M.MIDDLE_NAME,'')) CONCAT ( CASE WHEN M.MIDDLE_NAME IS NOT NULL AND M.LAST_NAME IS NOT NULL THEN ' '  WHEN M.FIRST_NAME IS NOT NULL AND M.MIDDLE_NAME IS NULL AND M.LAST_NAME IS NOT NULL THEN ' ' ELSE '' END CONCAT  COALESCE(M.LAST_NAME,'') ) AS MEM_NAME,
			FE.PRODUCT_ID AS PR_ID,
			PREF.SHORT_DESCRIPTION,
			PRO.PARTNUM AS PARTNUM,
			COUNT(FE.PRODUCT_ID) AS COUNT
		FROM 
			WCA.FACT_EVENT FE,
			WCA.MEMBER M,
			WCA.PRODUCT PRO,
			WCA.PERIOD P,
			WCA.PRODUCT_REF PREF
		WHERE 
			M.MEMBER_ID = FE.MEMBER_ID
			AND PREF.LANGUAGE_ID IN (
			SELECT INTEGER (PR.PARAM_VALUE) 
			FROM WCA.PARAMETERS PR 
			WHERE PR.PARAM_TYPE='REPORT_LANGUAGE') 
			AND FE.STORE_ID IN ({storeent_id})
			AND FE.PRODUCT_ID = PRO.PRODUCT_ID
			AND PREF.PRODUCT_ID = FE.PRODUCT_ID
			AND FE.EVENT_TYPE_ID = 2
			AND FE.PER_ID = P.PER_ID
			AND P.CALENDAR_DATE &gt;= $DB_TIMESTAMP_FUNC({StartDate})$
 			AND P.CALENDAR_DATE &lt;= $DB_TIMESTAMP_FUNC({EndDate})$
		GROUP BY
			FE.MEMBER_ID,
			FE.PRODUCT_ID,
			PRO.PARTNUM,
			M.FIRST_NAME,
			M.MIDDLE_NAME,
			M.LAST_NAME,
			PREF.SHORT_DESCRIPTION) AS T1
	WHERE
		 (T1.MEM_ID,T1.COUNT) IN(
		SELECT DISTINCT MEM_ID,MAX(COUNT)
		FROM(
			SELECT COUNT(FE.PRODUCT_ID) AS COUNT ,
				FE.MEMBER_ID AS MEM_ID,
				FE.PRODUCT_ID AS PR_ID 
			FROM 
				WCA.FACT_EVENT FE,
				WCA.MEMBER M,
				WCA.PRODUCT PRO,
				WCA.PERIOD P,
				WCA.PRODUCT_REF PREF
			WHERE 
				M.MEMBER_ID = FE.MEMBER_ID
				AND PREF.LANGUAGE_ID IN (
				SELECT INTEGER (PR.PARAM_VALUE) 
				FROM WCA.PARAMETERS PR 
				WHERE PR.PARAM_TYPE='REPORT_LANGUAGE') 
				AND FE.STORE_ID IN ({storeent_id})
				AND FE.PRODUCT_ID = PRO.PRODUCT_ID
				AND PREF.PRODUCT_ID = FE.PRODUCT_ID
				AND FE.EVENT_TYPE_ID = 2
				AND FE.PER_ID = P.PER_ID
				AND P.CALENDAR_DATE = (Current date -1 Days)
			GROUP BY
				FE.MEMBER_ID,
				FE.PRODUCT_ID
			) AS COUNT_TABLE
		GROUP BY MEM_ID
		)
		Order By COUNT ASC
		</SQLvalue>
		<display>
			<standardInfo>
				<resourceBundle>bi.biNLS</resourceBundle>
				<title>BAProductsLookedAtBySingleUser</title>
				<message>BAProductsLookedAtBySingleUser</message>
			</standardInfo>
			<userDefinedParameters>
				<THStyle>TH { font-family : Times New Roman, Times, serif; font-size : 10pt; color : #565665; font-weight : bold; }</THStyle>
				<TDStyle>TD { font-family : Verdana,  Arial, Helvetica; font-size : 9pt; color : Black; }</TDStyle>
				<spaceBetweenColumns>25</spaceBetweenColumns>
				<columnDefaultAttributes>
					<displayInReport>true</displayInReport>
					<columnWidth>0</columnWidth>
					<maxEntryLength>999</maxEntryLength>
					<columnType>string</columnType>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columnDefaultAttributes>
				<columns>
					<columnKey>C0</columnKey>
					<columnName>userId</columnName>
					<columnOptions>ALIGN=RIGHT HEIGHT=20 NOWRAP</columnOptions>
					<columnType>integer</columnType>
				</columns>
				<columns>
					<columnKey>C1</columnKey>
					<columnName>userName</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C2</columnKey>
					<columnName>partNum</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C3</columnKey>
					<columnName>prodName</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C4</columnKey>
					<columnName>prodDescrip</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C5</columnKey>
					<columnName>numOfProdViewed</columnName>
					<columnOptions>ALIGN=RIGHT HEIGHT=20 NOWRAP</columnOptions>
					<columnType>integer</columnType>					
				</columns>
			</userDefinedParameters>
		</display>
	</Report>
	<Report reportName="biBAProductsLookedAtBySingleUserReportYesterdayNumOfProdAddedAscend" online="true" dataSourceName="WCA DataSource">
		<comment></comment>
		<SQLvalue>
SELECT  *
	FROM(
	SELECT 	FE.MEMBER_ID AS MEM_ID,
			COALESCE(M.FIRST_NAME,'') CONCAT (CASE WHEN M.FIRST_NAME IS NOT NULL AND M.MIDDLE_NAME IS NOT NULL THEN ' ' ELSE '' END CONCAT COALESCE(M.MIDDLE_NAME,'')) CONCAT ( CASE WHEN M.MIDDLE_NAME IS NOT NULL AND M.LAST_NAME IS NOT NULL THEN ' '  WHEN M.FIRST_NAME IS NOT NULL AND M.MIDDLE_NAME IS NULL AND M.LAST_NAME IS NOT NULL THEN ' ' ELSE '' END CONCAT  COALESCE(M.LAST_NAME,'') ) AS MEM_NAME,
			FE.PRODUCT_ID AS PR_ID,
			PREF.SHORT_DESCRIPTION,
			PRO.PARTNUM AS PARTNUM,
			COUNT(FE.PRODUCT_ID) AS COUNT
		FROM 
			WCA.FACT_EVENT FE,
			WCA.MEMBER M,
			WCA.PRODUCT PRO,
			WCA.PERIOD P,
			WCA.PRODUCT_REF PREF
		WHERE 
			M.MEMBER_ID = FE.MEMBER_ID
			AND PREF.LANGUAGE_ID IN (
			SELECT INTEGER (PR.PARAM_VALUE) 
			FROM WCA.PARAMETERS PR 
			WHERE PR.PARAM_TYPE='REPORT_LANGUAGE') 
			AND FE.STORE_ID IN ({storeent_id})
			AND FE.PRODUCT_ID = PRO.PRODUCT_ID
			AND PREF.PRODUCT_ID = FE.PRODUCT_ID
			AND FE.EVENT_TYPE_ID = 2
			AND FE.PER_ID = P.PER_ID
			AND P.CALENDAR_DATE = (Current date -1 Days)
		GROUP BY
			FE.MEMBER_ID,
			FE.PRODUCT_ID,
			PRO.PARTNUM,
			M.FIRST_NAME,
			M.MIDDLE_NAME,
			M.LAST_NAME,
			PREF.SHORT_DESCRIPTION) AS T1
	WHERE
		 (T1.MEM_ID,T1.COUNT) IN(
		SELECT DISTINCT MEM_ID,MAX(COUNT)
		FROM(
			SELECT COUNT(FE.PRODUCT_ID) AS COUNT ,
				FE.MEMBER_ID AS MEM_ID,
				FE.PRODUCT_ID AS PR_ID 
			FROM 
				WCA.FACT_EVENT FE,
				WCA.MEMBER M,
				WCA.PRODUCT PRO,
				WCA.PERIOD P,
				WCA.PRODUCT_REF PREF
			WHERE 
				M.MEMBER_ID = FE.MEMBER_ID
				AND PREF.LANGUAGE_ID IN (
				SELECT INTEGER (PR.PARAM_VALUE) 
				FROM WCA.PARAMETERS PR 
				WHERE PR.PARAM_TYPE='REPORT_LANGUAGE') 
				AND FE.STORE_ID IN ({storeent_id})
				AND FE.PRODUCT_ID = PRO.PRODUCT_ID
				AND PREF.PRODUCT_ID = FE.PRODUCT_ID
				AND FE.EVENT_TYPE_ID = 2
				AND FE.PER_ID = P.PER_ID
				AND P.CALENDAR_DATE = (Current date -1 Days)
			GROUP BY
				FE.MEMBER_ID,
				FE.PRODUCT_ID
			) AS COUNT_TABLE
		GROUP BY
			MEM_ID
			) Order By COUNT ASC
		</SQLvalue>
		<display>
			<standardInfo>
				<resourceBundle>bi.biNLS</resourceBundle>
				<title>BAProductsLookedAtBySingleUser</title>
				<message>BAProductsLookedAtBySingleUser</message>
			</standardInfo>
			<userDefinedParameters>
				<THStyle>TH { font-family : Times New Roman, Times, serif; font-size : 10pt; color : #565665; font-weight : bold; }</THStyle>
				<TDStyle>TD { font-family : Verdana,  Arial, Helvetica; font-size : 9pt; color : Black; }</TDStyle>
				<spaceBetweenColumns>25</spaceBetweenColumns>
				<columnDefaultAttributes>
					<displayInReport>true</displayInReport>
					<columnWidth>0</columnWidth>
					<maxEntryLength>999</maxEntryLength>
					<columnType>string</columnType>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columnDefaultAttributes>
				<columns>
					<columnKey>C0</columnKey>
					<columnName>userId</columnName>
					<columnOptions>ALIGN=RIGHT HEIGHT=20 NOWRAP</columnOptions>
					<columnType>integer</columnType>
				</columns>
				<columns>
					<columnKey>C1</columnKey>
					<columnName>userName</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C2</columnKey>
					<columnName>partNum</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C3</columnKey>
					<columnName>prodName</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C4</columnKey>
					<columnName>prodDescrip</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C5</columnKey>
					<columnName>numOfProdViewed</columnName>
					<columnOptions>ALIGN=RIGHT HEIGHT=20 NOWRAP</columnOptions>
					<columnType>integer</columnType>					
				</columns>
			</userDefinedParameters>
		</display>
	</Report>
	<Report reportName="biBAProductsLookedAtBySingleUserReportWeeklyNumOfProdAddedAscend" online="true" dataSourceName="WCA DataSource">
		<comment></comment>
		<SQLvalue>
SELECT  *
	FROM(
	SELECT 	FE.MEMBER_ID AS MEM_ID,
			COALESCE(M.FIRST_NAME,'') CONCAT (CASE WHEN M.FIRST_NAME IS NOT NULL AND M.MIDDLE_NAME IS NOT NULL THEN ' ' ELSE '' END CONCAT COALESCE(M.MIDDLE_NAME,'')) CONCAT ( CASE WHEN M.MIDDLE_NAME IS NOT NULL AND M.LAST_NAME IS NOT NULL THEN ' '  WHEN M.FIRST_NAME IS NOT NULL AND M.MIDDLE_NAME IS NULL AND M.LAST_NAME IS NOT NULL THEN ' ' ELSE '' END CONCAT  COALESCE(M.LAST_NAME,'') ) AS MEM_NAME,
			FE.PRODUCT_ID AS PR_ID,
			PREF.SHORT_DESCRIPTION,
			PRO.PARTNUM AS PARTNUM,
			COUNT(FE.PRODUCT_ID) AS COUNT
		FROM 
			WCA.FACT_EVENT FE,
			WCA.MEMBER M,
			WCA.PRODUCT PRO,
			WCA.PERIOD P,
			WCA.PRODUCT_REF PREF
		WHERE 
			M.MEMBER_ID = FE.MEMBER_ID
			AND PREF.LANGUAGE_ID IN (
			SELECT INTEGER (PR.PARAM_VALUE) 
			FROM WCA.PARAMETERS PR 
			WHERE PR.PARAM_TYPE='REPORT_LANGUAGE') 
			AND FE.STORE_ID IN ({storeent_id})
			AND FE.PRODUCT_ID = PRO.PRODUCT_ID
			AND PREF.PRODUCT_ID = FE.PRODUCT_ID
			AND FE.EVENT_TYPE_ID = 2
			AND FE.PER_ID = P.PER_ID
						AND 
				(P.WK_OF_FY, FISCAL_YR) IN (
				SELECT
					WK_OF_FY,
					FISCAL_YR
				FROM
					WCA.PERIOD P
				WHERE
					P.CALENDAR_DATE=CURRENT DATE)

		GROUP BY
			FE.MEMBER_ID,
			FE.PRODUCT_ID,
			PRO.PARTNUM,
			M.FIRST_NAME,
			M.MIDDLE_NAME,
			M.LAST_NAME,
			PREF.SHORT_DESCRIPTION) AS T1
	WHERE
		 (T1.MEM_ID,T1.COUNT) IN(
		SELECT DISTINCT MEM_ID,MAX(COUNT)
		FROM(
			SELECT COUNT(FE.PRODUCT_ID) AS COUNT ,
				FE.MEMBER_ID AS MEM_ID,
				FE.PRODUCT_ID AS PR_ID 
			FROM 
				WCA.FACT_EVENT FE,
				WCA.MEMBER M,
				WCA.PRODUCT PRO,
				WCA.PERIOD P,
				WCA.PRODUCT_REF PREF
			WHERE 
				M.MEMBER_ID = FE.MEMBER_ID
				AND PREF.LANGUAGE_ID IN (
				SELECT INTEGER (PR.PARAM_VALUE) 
				FROM WCA.PARAMETERS PR 
				WHERE PR.PARAM_TYPE='REPORT_LANGUAGE') 
				AND FE.STORE_ID IN ({storeent_id})
				AND FE.PRODUCT_ID = PRO.PRODUCT_ID
				AND PREF.PRODUCT_ID = FE.PRODUCT_ID
				AND FE.EVENT_TYPE_ID = 2
				AND FE.PER_ID = P.PER_ID
							AND 
				(P.WK_OF_FY, FISCAL_YR) IN (
				SELECT
					WK_OF_FY,
					FISCAL_YR
				FROM
					WCA.PERIOD P
				WHERE
					P.CALENDAR_DATE=CURRENT DATE)

			GROUP BY
				FE.MEMBER_ID,
				FE.PRODUCT_ID
			) AS COUNT_TABLE
		GROUP BY
			MEM_ID
			) Order By COUNT ASC
		</SQLvalue>
		<display>
			<standardInfo>
				<resourceBundle>bi.biNLS</resourceBundle>
				<title>BAProductsLookedAtBySingleUser</title>
				<message>BAProductsLookedAtBySingleUser</message>
			</standardInfo>
			<userDefinedParameters>
				<THStyle>TH { font-family : Times New Roman, Times, serif; font-size : 10pt; color : #565665; font-weight : bold; }</THStyle>
				<TDStyle>TD { font-family : Verdana,  Arial, Helvetica; font-size : 9pt; color : Black; }</TDStyle>
				<spaceBetweenColumns>25</spaceBetweenColumns>
				<columnDefaultAttributes>
					<displayInReport>true</displayInReport>
					<columnWidth>0</columnWidth>
					<maxEntryLength>999</maxEntryLength>
					<columnType>string</columnType>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columnDefaultAttributes>
				<columns>
					<columnKey>C0</columnKey>
					<columnName>userId</columnName>
					<columnOptions>ALIGN=RIGHT HEIGHT=20 NOWRAP</columnOptions>
					<columnType>integer</columnType>
				</columns>
				<columns>
					<columnKey>C1</columnKey>
					<columnName>userName</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C2</columnKey>
					<columnName>partNum</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C3</columnKey>
					<columnName>prodName</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C4</columnKey>
					<columnName>prodDescrip</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C5</columnKey>
					<columnName>numOfProdViewed</columnName>
					<columnOptions>ALIGN=RIGHT HEIGHT=20 NOWRAP</columnOptions>
					<columnType>integer</columnType>					
				</columns>
			</userDefinedParameters>
		</display>
	</Report>
	<Report reportName="biBAProductsLookedAtBySingleUserReportMonthlyNumOfProdAddedAscend" online="true" dataSourceName="WCA DataSource">
		<comment></comment>
		<SQLvalue>
SELECT  *
	FROM(
	SELECT 	FE.MEMBER_ID AS MEM_ID,
			COALESCE(M.FIRST_NAME,'') CONCAT (CASE WHEN M.FIRST_NAME IS NOT NULL AND M.MIDDLE_NAME IS NOT NULL THEN ' ' ELSE '' END CONCAT COALESCE(M.MIDDLE_NAME,'')) CONCAT ( CASE WHEN M.MIDDLE_NAME IS NOT NULL AND M.LAST_NAME IS NOT NULL THEN ' '  WHEN M.FIRST_NAME IS NOT NULL AND M.MIDDLE_NAME IS NULL AND M.LAST_NAME IS NOT NULL THEN ' ' ELSE '' END CONCAT  COALESCE(M.LAST_NAME,'') ) AS MEM_NAME,
			FE.PRODUCT_ID AS PR_ID,
			PREF.SHORT_DESCRIPTION,
			PRO.PARTNUM AS PARTNUM,
			COUNT(FE.PRODUCT_ID) AS COUNT
		FROM 
			WCA.FACT_EVENT FE,
			WCA.MEMBER M,
			WCA.PRODUCT PRO,
			WCA.PERIOD P,
			WCA.PRODUCT_REF PREF
		WHERE 
			M.MEMBER_ID = FE.MEMBER_ID
			AND PREF.LANGUAGE_ID IN (
			SELECT INTEGER (PR.PARAM_VALUE) 
			FROM WCA.PARAMETERS PR 
			WHERE PR.PARAM_TYPE='REPORT_LANGUAGE') 
			AND FE.STORE_ID IN ({storeent_id})
			AND FE.PRODUCT_ID = PRO.PRODUCT_ID
			AND PREF.PRODUCT_ID = FE.PRODUCT_ID
			AND FE.EVENT_TYPE_ID = 2
			AND FE.PER_ID = P.PER_ID
			AND (P.MON_OF_FY, FISCAL_YR) IN (
			SELECT
				MON_OF_FY,
				FISCAL_YR
			FROM
				WCA.PERIOD P
			WHERE
				P.CALENDAR_DATE=CURRENT DATE)

		GROUP BY
			FE.MEMBER_ID,
			FE.PRODUCT_ID,
			PRO.PARTNUM,
			M.FIRST_NAME,
			M.MIDDLE_NAME,
			M.LAST_NAME,
			PREF.SHORT_DESCRIPTION) AS T1
	WHERE
		 (T1.MEM_ID,T1.COUNT) IN(
		SELECT DISTINCT MEM_ID,MAX(COUNT)
		FROM(
			SELECT COUNT(FE.PRODUCT_ID) AS COUNT ,
				FE.MEMBER_ID AS MEM_ID,
				FE.PRODUCT_ID AS PR_ID 
			FROM 
				WCA.FACT_EVENT FE,
				WCA.MEMBER M,
				WCA.PRODUCT PRO,
				WCA.PERIOD P,
				WCA.PRODUCT_REF PREF
			WHERE 
				M.MEMBER_ID = FE.MEMBER_ID
				AND PREF.LANGUAGE_ID IN (
				SELECT INTEGER (PR.PARAM_VALUE) 
				FROM WCA.PARAMETERS PR 
				WHERE PR.PARAM_TYPE='REPORT_LANGUAGE') 
				AND FE.STORE_ID IN ({storeent_id})
				AND FE.PRODUCT_ID = PRO.PRODUCT_ID
				AND PREF.PRODUCT_ID = FE.PRODUCT_ID
				AND FE.EVENT_TYPE_ID = 2
				AND FE.PER_ID = P.PER_ID
				AND 
				(P.MON_OF_FY, FISCAL_YR) IN (
				SELECT
					MON_OF_FY,
					FISCAL_YR
				FROM
					WCA.PERIOD P
				WHERE
					P.CALENDAR_DATE=CURRENT DATE)

			GROUP BY
				FE.MEMBER_ID,
				FE.PRODUCT_ID
			) AS COUNT_TABLE
		GROUP BY
			MEM_ID
			) Order By COUNT ASC
		</SQLvalue>
		<display>
			<standardInfo>
				<resourceBundle>bi.biNLS</resourceBundle>
				<title>BAProductsLookedAtBySingleUser</title>
				<message>BAProductsLookedAtBySingleUser</message>
			</standardInfo>
			<userDefinedParameters>
				<THStyle>TH { font-family : Times New Roman, Times, serif; font-size : 10pt; color : #565665; font-weight : bold; }</THStyle>
				<TDStyle>TD { font-family : Verdana,  Arial, Helvetica; font-size : 9pt; color : Black; }</TDStyle>
				<spaceBetweenColumns>25</spaceBetweenColumns>
				<columnDefaultAttributes>
					<displayInReport>true</displayInReport>
					<columnWidth>0</columnWidth>
					<maxEntryLength>999</maxEntryLength>
					<columnType>string</columnType>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columnDefaultAttributes>
				<columns>
					<columnKey>C0</columnKey>
					<columnName>userId</columnName>
					<columnOptions>ALIGN=RIGHT HEIGHT=20 NOWRAP</columnOptions>
					<columnType>integer</columnType>
				</columns>
				<columns>
					<columnKey>C1</columnKey>
					<columnName>userName</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C2</columnKey>
					<columnName>partNum</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C3</columnKey>
					<columnName>prodName</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C4</columnKey>
					<columnName>prodDescrip</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C5</columnKey>
					<columnName>numOfProdViewed</columnName>
					<columnOptions>ALIGN=RIGHT HEIGHT=20 NOWRAP</columnOptions>
					<columnType>integer</columnType>					
				</columns>
			</userDefinedParameters>
		</display>
	</Report>
		<Report reportName="biBAProductsLookedAtBySingleUserReportQuarterlyNumOfProdAddedAscend" online="true" dataSourceName="WCA DataSource">
		<comment></comment>
		<SQLvalue>
SELECT  *
	FROM(
	SELECT 	FE.MEMBER_ID AS MEM_ID,
			COALESCE(M.FIRST_NAME,'') CONCAT (CASE WHEN M.FIRST_NAME IS NOT NULL AND M.MIDDLE_NAME IS NOT NULL THEN ' ' ELSE '' END CONCAT COALESCE(M.MIDDLE_NAME,'')) CONCAT ( CASE WHEN M.MIDDLE_NAME IS NOT NULL AND M.LAST_NAME IS NOT NULL THEN ' '  WHEN M.FIRST_NAME IS NOT NULL AND M.MIDDLE_NAME IS NULL AND M.LAST_NAME IS NOT NULL THEN ' ' ELSE '' END CONCAT  COALESCE(M.LAST_NAME,'') ) AS MEM_NAME,
			FE.PRODUCT_ID AS PR_ID,
			PREF.SHORT_DESCRIPTION,
			PRO.PARTNUM AS PARTNUM,
			COUNT(FE.PRODUCT_ID) AS COUNT
		FROM 
			WCA.FACT_EVENT FE,
			WCA.MEMBER M,
			WCA.PRODUCT PRO,
			WCA.PERIOD P,
			WCA.PRODUCT_REF PREF
		WHERE 
			M.MEMBER_ID = FE.MEMBER_ID
			AND PREF.LANGUAGE_ID IN (
			SELECT INTEGER (PR.PARAM_VALUE) 
			FROM WCA.PARAMETERS PR 
			WHERE PR.PARAM_TYPE='REPORT_LANGUAGE') 
			AND FE.STORE_ID IN ({storeent_id})
			AND FE.PRODUCT_ID = PRO.PRODUCT_ID
			AND PREF.PRODUCT_ID = FE.PRODUCT_ID
			AND FE.EVENT_TYPE_ID = 2
			AND FE.PER_ID = P.PER_ID
			AND (P.QTR_OF_FY, FISCAL_YR) IN (
				SELECT
					QTR_OF_FY,
					FISCAL_YR
				FROM
					WCA.PERIOD P
				WHERE
					P.CALENDAR_DATE=CURRENT DATE)
		GROUP BY
			FE.MEMBER_ID,
			FE.PRODUCT_ID,
			PRO.PARTNUM,
			M.FIRST_NAME,
			M.MIDDLE_NAME,
			M.LAST_NAME,
			PREF.SHORT_DESCRIPTION) AS T1
	WHERE
		 (T1.MEM_ID,T1.COUNT) IN(
		SELECT DISTINCT MEM_ID,MAX(COUNT)
		FROM(
			SELECT COUNT(FE.PRODUCT_ID) AS COUNT ,
				FE.MEMBER_ID AS MEM_ID,
				FE.PRODUCT_ID AS PR_ID 
			FROM 
				WCA.FACT_EVENT FE,
				WCA.MEMBER M,
				WCA.PRODUCT PRO,
				WCA.PERIOD P,
				WCA.PRODUCT_REF PREF
			WHERE 
				M.MEMBER_ID = FE.MEMBER_ID
				AND PREF.LANGUAGE_ID IN (
				SELECT INTEGER (PR.PARAM_VALUE) 
				FROM WCA.PARAMETERS PR 
				WHERE PR.PARAM_TYPE='REPORT_LANGUAGE') 
				AND FE.STORE_ID IN ({storeent_id})
				AND FE.PRODUCT_ID = PRO.PRODUCT_ID
				AND PREF.PRODUCT_ID = FE.PRODUCT_ID
				AND FE.EVENT_TYPE_ID = 2
				AND FE.PER_ID = P.PER_ID
				AND (P.QTR_OF_FY, FISCAL_YR) IN (
				SELECT
					QTR_OF_FY,
					FISCAL_YR
				FROM
					WCA.PERIOD P
				WHERE
					P.CALENDAR_DATE=CURRENT DATE)
			GROUP BY
				FE.MEMBER_ID,
				FE.PRODUCT_ID
			) AS COUNT_TABLE
		GROUP BY
			MEM_ID
			) Order By COUNT ASC
		</SQLvalue>
		<display>
			<standardInfo>
				<resourceBundle>bi.biNLS</resourceBundle>
				<title>BAProductsLookedAtBySingleUser</title>
				<message>BAProductsLookedAtBySingleUser</message>
			</standardInfo>
			<userDefinedParameters>
				<THStyle>TH { font-family : Times New Roman, Times, serif; font-size : 10pt; color : #565665; font-weight : bold; }</THStyle>
				<TDStyle>TD { font-family : Verdana,  Arial, Helvetica; font-size : 9pt; color : Black; }</TDStyle>
				<spaceBetweenColumns>25</spaceBetweenColumns>
				<columnDefaultAttributes>
					<displayInReport>true</displayInReport>
					<columnWidth>0</columnWidth>
					<maxEntryLength>999</maxEntryLength>
					<columnType>string</columnType>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columnDefaultAttributes>
				<columns>
					<columnKey>C0</columnKey>
					<columnName>userId</columnName>
					<columnOptions>ALIGN=RIGHT HEIGHT=20 NOWRAP</columnOptions>
					<columnType>integer</columnType>
				</columns>
				<columns>
					<columnKey>C1</columnKey>
					<columnName>userName</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C2</columnKey>
					<columnName>partNum</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C3</columnKey>
					<columnName>prodName</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C4</columnKey>
					<columnName>prodDescrip</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C5</columnKey>
					<columnName>numOfProdViewed</columnName>
					<columnOptions>ALIGN=RIGHT HEIGHT=20 NOWRAP</columnOptions>
					<columnType>integer</columnType>					
				</columns>
			</userDefinedParameters>
		</display>
	</Report>
	<Report reportName="biBAProductsLookedAtBySingleUserReportYearlyNumOfProdAddedAscend" online="true" dataSourceName="WCA DataSource">
		<comment></comment>
		<SQLvalue>
SELECT  *
	FROM(
	SELECT 	FE.MEMBER_ID AS MEM_ID,
			COALESCE(M.FIRST_NAME,'') CONCAT (CASE WHEN M.FIRST_NAME IS NOT NULL AND M.MIDDLE_NAME IS NOT NULL THEN ' ' ELSE '' END CONCAT COALESCE(M.MIDDLE_NAME,'')) CONCAT ( CASE WHEN M.MIDDLE_NAME IS NOT NULL AND M.LAST_NAME IS NOT NULL THEN ' '  WHEN M.FIRST_NAME IS NOT NULL AND M.MIDDLE_NAME IS NULL AND M.LAST_NAME IS NOT NULL THEN ' ' ELSE '' END CONCAT  COALESCE(M.LAST_NAME,'') ) AS MEM_NAME,
			FE.PRODUCT_ID AS PR_ID,
			PREF.SHORT_DESCRIPTION,
			PRO.PARTNUM AS PARTNUM,
			COUNT(FE.PRODUCT_ID) AS COUNT
		FROM 
			WCA.FACT_EVENT FE,
			WCA.MEMBER M,
			WCA.PRODUCT PRO,
			WCA.PERIOD P,
			WCA.PRODUCT_REF PREF
		WHERE 
			M.MEMBER_ID = FE.MEMBER_ID
			AND PREF.LANGUAGE_ID IN (
			SELECT INTEGER (PR.PARAM_VALUE) 
			FROM WCA.PARAMETERS PR 
			WHERE PR.PARAM_TYPE='REPORT_LANGUAGE') 
			AND FE.STORE_ID IN ({storeent_id})
			AND FE.PRODUCT_ID = PRO.PRODUCT_ID
			AND PREF.PRODUCT_ID = FE.PRODUCT_ID
			AND FE.EVENT_TYPE_ID = 2
			AND FE.PER_ID = P.PER_ID
			AND P.FISCAL_YR = (
			SELECT
				FISCAL_YR
			FROM
				WCA.PERIOD
			WHERE
				CALENDAR_DATE=CURRENT DATE)

		GROUP BY
			FE.MEMBER_ID,
			FE.PRODUCT_ID,
			PRO.PARTNUM,
			M.FIRST_NAME,
			M.MIDDLE_NAME,
			M.LAST_NAME,
			PREF.SHORT_DESCRIPTION) AS T1
	WHERE
		 (T1.MEM_ID,T1.COUNT) IN(
		SELECT DISTINCT MEM_ID,MAX(COUNT)
		FROM(
			SELECT COUNT(FE.PRODUCT_ID) AS COUNT ,
				FE.MEMBER_ID AS MEM_ID,
				FE.PRODUCT_ID AS PR_ID 
			FROM 
				WCA.FACT_EVENT FE,
				WCA.MEMBER M,
				WCA.PRODUCT PRO,
				WCA.PERIOD P,
				WCA.PRODUCT_REF PREF
			WHERE 
				M.MEMBER_ID = FE.MEMBER_ID
				AND PREF.LANGUAGE_ID IN (
				SELECT INTEGER (PR.PARAM_VALUE) 
				FROM WCA.PARAMETERS PR 
				WHERE PR.PARAM_TYPE='REPORT_LANGUAGE') 
				AND FE.STORE_ID IN ({storeent_id})
				AND FE.PRODUCT_ID = PRO.PRODUCT_ID
				AND PREF.PRODUCT_ID = FE.PRODUCT_ID
				AND FE.EVENT_TYPE_ID = 2
				AND FE.PER_ID = P.PER_ID
					AND P.FISCAL_YR = (
				SELECT
					FISCAL_YR
				FROM
					WCA.PERIOD
				WHERE
					CALENDAR_DATE=CURRENT DATE)

			GROUP BY
				FE.MEMBER_ID,
				FE.PRODUCT_ID
			) AS COUNT_TABLE
		GROUP BY
			MEM_ID
			) Order By COUNT ASC
		</SQLvalue>
		<display>
			<standardInfo>
				<resourceBundle>bi.biNLS</resourceBundle>
				<title>BAProductsLookedAtBySingleUser</title>
				<message>BAProductsLookedAtBySingleUser</message>
			</standardInfo>
			<userDefinedParameters>
				<THStyle>TH { font-family : Times New Roman, Times, serif; font-size : 10pt; color : #565665; font-weight : bold; }</THStyle>
				<TDStyle>TD { font-family : Verdana,  Arial, Helvetica; font-size : 9pt; color : Black; }</TDStyle>
				<spaceBetweenColumns>25</spaceBetweenColumns>
				<columnDefaultAttributes>
					<displayInReport>true</displayInReport>
					<columnWidth>0</columnWidth>
					<maxEntryLength>999</maxEntryLength>
					<columnType>string</columnType>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columnDefaultAttributes>
				<columns>
					<columnKey>C0</columnKey>
					<columnName>userId</columnName>
					<columnOptions>ALIGN=RIGHT HEIGHT=20 NOWRAP</columnOptions>
					<columnType>integer</columnType>
				</columns>
				<columns>
					<columnKey>C1</columnKey>
					<columnName>userName</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C2</columnKey>
					<columnName>partNum</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C3</columnKey>
					<columnName>prodName</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C4</columnKey>
					<columnName>prodDescrip</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C5</columnKey>
					<columnName>numOfProdViewed</columnName>
					<columnOptions>ALIGN=RIGHT HEIGHT=20 NOWRAP</columnOptions>
					<columnType>integer</columnType>					
				</columns>
			</userDefinedParameters>
		</display>
	</Report>
	<Report reportName="biBAProductsLookedAtBySingleUserReportProductName" online="true" dataSourceName="WCA DataSource">
		<comment></comment>
		<SQLvalue>
SELECT  *
	FROM(
	SELECT 	FE.MEMBER_ID AS MEM_ID,
			COALESCE(M.FIRST_NAME,'') CONCAT (CASE WHEN M.FIRST_NAME IS NOT NULL AND M.MIDDLE_NAME IS NOT NULL THEN ' ' ELSE '' END CONCAT COALESCE(M.MIDDLE_NAME,'')) CONCAT ( CASE WHEN M.MIDDLE_NAME IS NOT NULL AND M.LAST_NAME IS NOT NULL THEN ' '  WHEN M.FIRST_NAME IS NOT NULL AND M.MIDDLE_NAME IS NULL AND M.LAST_NAME IS NOT NULL THEN ' ' ELSE '' END CONCAT  COALESCE(M.LAST_NAME,'') ) AS MEM_NAME,
			FE.PRODUCT_ID AS PR_ID,
			PREF.SHORT_DESCRIPTION AS PROD_NAME,
			PRO.PARTNUM AS PARTNUM,
			COUNT(FE.PRODUCT_ID) AS COUNT
		FROM 
			WCA.FACT_EVENT FE,
			WCA.MEMBER M,
			WCA.PRODUCT PRO,
			WCA.PERIOD P,
			WCA.PRODUCT_REF PREF
		WHERE 
			M.MEMBER_ID = FE.MEMBER_ID
			AND PREF.LANGUAGE_ID IN (
			SELECT INTEGER (PR.PARAM_VALUE) 
			FROM WCA.PARAMETERS PR 
			WHERE PR.PARAM_TYPE='REPORT_LANGUAGE') 
			AND FE.STORE_ID IN ({storeent_id})
			AND FE.PRODUCT_ID = PRO.PRODUCT_ID
			AND PREF.PRODUCT_ID = FE.PRODUCT_ID
			AND FE.EVENT_TYPE_ID = 2
			AND FE.PER_ID = P.PER_ID
			AND P.CALENDAR_DATE &gt;= $DB_TIMESTAMP_FUNC({StartDate})$
 			AND P.CALENDAR_DATE &lt;= $DB_TIMESTAMP_FUNC({EndDate})$
		GROUP BY
			FE.MEMBER_ID,
			FE.PRODUCT_ID,
			PRO.PARTNUM,
			M.FIRST_NAME,
			M.MIDDLE_NAME,
			M.LAST_NAME,
			PREF.SHORT_DESCRIPTION) AS T1
	WHERE
		 (T1.MEM_ID,T1.COUNT) IN(
		SELECT DISTINCT MEM_ID,MAX(COUNT)
		FROM(
			SELECT COUNT(FE.PRODUCT_ID) AS COUNT ,
				FE.MEMBER_ID AS MEM_ID,
				FE.PRODUCT_ID AS PR_ID 
			FROM 
				WCA.FACT_EVENT FE,
				WCA.MEMBER M,
				WCA.PRODUCT PRO,
				WCA.PERIOD P,
				WCA.PRODUCT_REF PREF
			WHERE 
				M.MEMBER_ID = FE.MEMBER_ID
				AND PREF.LANGUAGE_ID IN (
				SELECT INTEGER (PR.PARAM_VALUE) 
				FROM WCA.PARAMETERS PR 
				WHERE PR.PARAM_TYPE='REPORT_LANGUAGE') 
				AND FE.STORE_ID IN ({storeent_id})
				AND FE.PRODUCT_ID = PRO.PRODUCT_ID
				AND PREF.PRODUCT_ID = FE.PRODUCT_ID
				AND FE.EVENT_TYPE_ID = 2
				AND FE.PER_ID = P.PER_ID
				AND P.CALENDAR_DATE = (Current date -1 Days)
			GROUP BY
				FE.MEMBER_ID,
				FE.PRODUCT_ID
			) AS COUNT_TABLE
		GROUP BY MEM_ID
		)
		Order By 4 DESC
		</SQLvalue>
		<display>
			<standardInfo>
				<resourceBundle>bi.biNLS</resourceBundle>
				<title>BAProductsLookedAtBySingleUser</title>
				<message>BAProductsLookedAtBySingleUser</message>
			</standardInfo>
			<userDefinedParameters>
				<THStyle>TH { font-family : Times New Roman, Times, serif; font-size : 10pt; color : #565665; font-weight : bold; }</THStyle>
				<TDStyle>TD { font-family : Verdana,  Arial, Helvetica; font-size : 9pt; color : Black; }</TDStyle>
				<spaceBetweenColumns>25</spaceBetweenColumns>
				<columnDefaultAttributes>
					<displayInReport>true</displayInReport>
					<columnWidth>0</columnWidth>
					<maxEntryLength>999</maxEntryLength>
					<columnType>string</columnType>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columnDefaultAttributes>
				<columns>
					<columnKey>C0</columnKey>
					<columnName>userId</columnName>
					<columnOptions>ALIGN=RIGHT HEIGHT=20 NOWRAP</columnOptions>
					<columnType>integer</columnType>
				</columns>
				<columns>
					<columnKey>C1</columnKey>
					<columnName>userName</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C2</columnKey>
					<columnName>partNum</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C3</columnKey>
					<columnName>prodName</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C4</columnKey>
					<columnName>prodDescrip</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C5</columnKey>
					<columnName>numOfProdViewed</columnName>
					<columnOptions>ALIGN=RIGHT HEIGHT=20 NOWRAP</columnOptions>
					<columnType>integer</columnType>					
				</columns>
			</userDefinedParameters>
		</display>
	</Report>
	<Report reportName="biBAProductsLookedAtBySingleUserReportYesterdayProductName" online="true" dataSourceName="WCA DataSource">
		<comment></comment>
		<SQLvalue>
SELECT  *
	FROM(
	SELECT 	FE.MEMBER_ID AS MEM_ID,
			COALESCE(M.FIRST_NAME,'') CONCAT (CASE WHEN M.FIRST_NAME IS NOT NULL AND M.MIDDLE_NAME IS NOT NULL THEN ' ' ELSE '' END CONCAT COALESCE(M.MIDDLE_NAME,'')) CONCAT ( CASE WHEN M.MIDDLE_NAME IS NOT NULL AND M.LAST_NAME IS NOT NULL THEN ' '  WHEN M.FIRST_NAME IS NOT NULL AND M.MIDDLE_NAME IS NULL AND M.LAST_NAME IS NOT NULL THEN ' ' ELSE '' END CONCAT  COALESCE(M.LAST_NAME,'') ) AS MEM_NAME,
			FE.PRODUCT_ID AS PR_ID,
			PREF.SHORT_DESCRIPTION,
			PRO.PARTNUM AS PARTNUM,
			COUNT(FE.PRODUCT_ID) AS COUNT
		FROM 
			WCA.FACT_EVENT FE,
			WCA.MEMBER M,
			WCA.PRODUCT PRO,
			WCA.PERIOD P,
			WCA.PRODUCT_REF PREF
		WHERE 
			M.MEMBER_ID = FE.MEMBER_ID
			AND PREF.LANGUAGE_ID IN (
			SELECT INTEGER (PR.PARAM_VALUE) 
			FROM WCA.PARAMETERS PR 
			WHERE PR.PARAM_TYPE='REPORT_LANGUAGE') 
			AND FE.STORE_ID IN ({storeent_id})
			AND FE.PRODUCT_ID = PRO.PRODUCT_ID
			AND PREF.PRODUCT_ID = FE.PRODUCT_ID
			AND FE.EVENT_TYPE_ID = 2
			AND FE.PER_ID = P.PER_ID
			AND P.CALENDAR_DATE = (Current date -1 Days)
		GROUP BY
			FE.MEMBER_ID,
			FE.PRODUCT_ID,
			PRO.PARTNUM,
			M.FIRST_NAME,
			M.MIDDLE_NAME,
			M.LAST_NAME,
			PREF.SHORT_DESCRIPTION) AS T1
	WHERE
		 (T1.MEM_ID,T1.COUNT) IN(
		SELECT DISTINCT MEM_ID,MAX(COUNT)
		FROM(
			SELECT COUNT(FE.PRODUCT_ID) AS COUNT ,
				FE.MEMBER_ID AS MEM_ID,
				FE.PRODUCT_ID AS PR_ID 
			FROM 
				WCA.FACT_EVENT FE,
				WCA.MEMBER M,
				WCA.PRODUCT PRO,
				WCA.PERIOD P,
				WCA.PRODUCT_REF PREF
			WHERE 
				M.MEMBER_ID = FE.MEMBER_ID
				AND PREF.LANGUAGE_ID IN (
				SELECT INTEGER (PR.PARAM_VALUE) 
				FROM WCA.PARAMETERS PR 
				WHERE PR.PARAM_TYPE='REPORT_LANGUAGE') 
				AND FE.STORE_ID IN ({storeent_id})
				AND FE.PRODUCT_ID = PRO.PRODUCT_ID
				AND PREF.PRODUCT_ID = FE.PRODUCT_ID
				AND FE.EVENT_TYPE_ID = 2
				AND FE.PER_ID = P.PER_ID
				AND P.CALENDAR_DATE = (Current date -1 Days)
			GROUP BY
				FE.MEMBER_ID,
				FE.PRODUCT_ID
			) AS COUNT_TABLE
		GROUP BY
			MEM_ID
			) Order By 4 DESC
		</SQLvalue>
		<display>
			<standardInfo>
				<resourceBundle>bi.biNLS</resourceBundle>
				<title>BAProductsLookedAtBySingleUser</title>
				<message>BAProductsLookedAtBySingleUser</message>
			</standardInfo>
			<userDefinedParameters>
				<THStyle>TH { font-family : Times New Roman, Times, serif; font-size : 10pt; color : #565665; font-weight : bold; }</THStyle>
				<TDStyle>TD { font-family : Verdana,  Arial, Helvetica; font-size : 9pt; color : Black; }</TDStyle>
				<spaceBetweenColumns>25</spaceBetweenColumns>
				<columnDefaultAttributes>
					<displayInReport>true</displayInReport>
					<columnWidth>0</columnWidth>
					<maxEntryLength>999</maxEntryLength>
					<columnType>string</columnType>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columnDefaultAttributes>
				<columns>
					<columnKey>C0</columnKey>
					<columnName>userId</columnName>
					<columnOptions>ALIGN=RIGHT HEIGHT=20 NOWRAP</columnOptions>
					<columnType>integer</columnType>
				</columns>
				<columns>
					<columnKey>C1</columnKey>
					<columnName>userName</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C2</columnKey>
					<columnName>partNum</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C3</columnKey>
					<columnName>prodName</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C4</columnKey>
					<columnName>prodDescrip</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C5</columnKey>
					<columnName>numOfProdViewed</columnName>
					<columnOptions>ALIGN=RIGHT HEIGHT=20 NOWRAP</columnOptions>
					<columnType>integer</columnType>					
				</columns>
			</userDefinedParameters>
		</display>
	</Report>
	<Report reportName="biBAProductsLookedAtBySingleUserReportWeeklyProductName" online="true" dataSourceName="WCA DataSource">
		<comment></comment>
		<SQLvalue>
SELECT  *
	FROM(
	SELECT 	FE.MEMBER_ID AS MEM_ID,
			COALESCE(M.FIRST_NAME,'') CONCAT (CASE WHEN M.FIRST_NAME IS NOT NULL AND M.MIDDLE_NAME IS NOT NULL THEN ' ' ELSE '' END CONCAT COALESCE(M.MIDDLE_NAME,'')) CONCAT ( CASE WHEN M.MIDDLE_NAME IS NOT NULL AND M.LAST_NAME IS NOT NULL THEN ' '  WHEN M.FIRST_NAME IS NOT NULL AND M.MIDDLE_NAME IS NULL AND M.LAST_NAME IS NOT NULL THEN ' ' ELSE '' END CONCAT  COALESCE(M.LAST_NAME,'') ) AS MEM_NAME,
			FE.PRODUCT_ID AS PR_ID,
			PREF.SHORT_DESCRIPTION,
			PRO.PARTNUM AS PARTNUM,
			COUNT(FE.PRODUCT_ID) AS COUNT
		FROM 
			WCA.FACT_EVENT FE,
			WCA.MEMBER M,
			WCA.PRODUCT PRO,
			WCA.PERIOD P,
			WCA.PRODUCT_REF PREF
		WHERE 
			M.MEMBER_ID = FE.MEMBER_ID
			AND PREF.LANGUAGE_ID IN (
			SELECT INTEGER (PR.PARAM_VALUE) 
			FROM WCA.PARAMETERS PR 
			WHERE PR.PARAM_TYPE='REPORT_LANGUAGE') 
			AND FE.STORE_ID IN ({storeent_id})
			AND FE.PRODUCT_ID = PRO.PRODUCT_ID
			AND PREF.PRODUCT_ID = FE.PRODUCT_ID
			AND FE.EVENT_TYPE_ID = 2
			AND FE.PER_ID = P.PER_ID
						AND 
				(P.WK_OF_FY, FISCAL_YR) IN (
				SELECT
					WK_OF_FY,
					FISCAL_YR
				FROM
					WCA.PERIOD P
				WHERE
					P.CALENDAR_DATE=CURRENT DATE)

		GROUP BY
			FE.MEMBER_ID,
			FE.PRODUCT_ID,
			PRO.PARTNUM,
			M.FIRST_NAME,
			M.MIDDLE_NAME,
			M.LAST_NAME,
			PREF.SHORT_DESCRIPTION) AS T1
	WHERE
		 (T1.MEM_ID,T1.COUNT) IN(
		SELECT DISTINCT MEM_ID,MAX(COUNT)
		FROM(
			SELECT COUNT(FE.PRODUCT_ID) AS COUNT ,
				FE.MEMBER_ID AS MEM_ID,
				FE.PRODUCT_ID AS PR_ID 
			FROM 
				WCA.FACT_EVENT FE,
				WCA.MEMBER M,
				WCA.PRODUCT PRO,
				WCA.PERIOD P,
				WCA.PRODUCT_REF PREF
			WHERE 
				M.MEMBER_ID = FE.MEMBER_ID
				AND PREF.LANGUAGE_ID IN (
				SELECT INTEGER (PR.PARAM_VALUE) 
				FROM WCA.PARAMETERS PR 
				WHERE PR.PARAM_TYPE='REPORT_LANGUAGE') 
				AND FE.STORE_ID IN ({storeent_id})
				AND FE.PRODUCT_ID = PRO.PRODUCT_ID
				AND PREF.PRODUCT_ID = FE.PRODUCT_ID
				AND FE.EVENT_TYPE_ID = 2
				AND FE.PER_ID = P.PER_ID
							AND 
				(P.WK_OF_FY, FISCAL_YR) IN (
				SELECT
					WK_OF_FY,
					FISCAL_YR
				FROM
					WCA.PERIOD P
				WHERE
					P.CALENDAR_DATE=CURRENT DATE)

			GROUP BY
				FE.MEMBER_ID,
				FE.PRODUCT_ID
			) AS COUNT_TABLE
		GROUP BY
			MEM_ID
			) Order By 4 DESC
		</SQLvalue>
		<display>
			<standardInfo>
				<resourceBundle>bi.biNLS</resourceBundle>
				<title>BAProductsLookedAtBySingleUser</title>
				<message>BAProductsLookedAtBySingleUser</message>
			</standardInfo>
			<userDefinedParameters>
				<THStyle>TH { font-family : Times New Roman, Times, serif; font-size : 10pt; color : #565665; font-weight : bold; }</THStyle>
				<TDStyle>TD { font-family : Verdana,  Arial, Helvetica; font-size : 9pt; color : Black; }</TDStyle>
				<spaceBetweenColumns>25</spaceBetweenColumns>
				<columnDefaultAttributes>
					<displayInReport>true</displayInReport>
					<columnWidth>0</columnWidth>
					<maxEntryLength>999</maxEntryLength>
					<columnType>string</columnType>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columnDefaultAttributes>
				<columns>
					<columnKey>C0</columnKey>
					<columnName>userId</columnName>
					<columnOptions>ALIGN=RIGHT HEIGHT=20 NOWRAP</columnOptions>
					<columnType>integer</columnType>
				</columns>
				<columns>
					<columnKey>C1</columnKey>
					<columnName>userName</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C2</columnKey>
					<columnName>partNum</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C3</columnKey>
					<columnName>prodName</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C4</columnKey>
					<columnName>prodDescrip</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C5</columnKey>
					<columnName>numOfProdViewed</columnName>
					<columnOptions>ALIGN=RIGHT HEIGHT=20 NOWRAP</columnOptions>
					<columnType>integer</columnType>					
				</columns>
			</userDefinedParameters>
		</display>
	</Report>
	<Report reportName="biBAProductsLookedAtBySingleUserReportMonthlyProductName" online="true" dataSourceName="WCA DataSource">
		<comment></comment>
		<SQLvalue>
SELECT  *
	FROM(
	SELECT 	FE.MEMBER_ID AS MEM_ID,
			COALESCE(M.FIRST_NAME,'') CONCAT (CASE WHEN M.FIRST_NAME IS NOT NULL AND M.MIDDLE_NAME IS NOT NULL THEN ' ' ELSE '' END CONCAT COALESCE(M.MIDDLE_NAME,'')) CONCAT ( CASE WHEN M.MIDDLE_NAME IS NOT NULL AND M.LAST_NAME IS NOT NULL THEN ' '  WHEN M.FIRST_NAME IS NOT NULL AND M.MIDDLE_NAME IS NULL AND M.LAST_NAME IS NOT NULL THEN ' ' ELSE '' END CONCAT  COALESCE(M.LAST_NAME,'') ) AS MEM_NAME,
			FE.PRODUCT_ID AS PR_ID,
			PREF.SHORT_DESCRIPTION,
			PRO.PARTNUM AS PARTNUM,
			COUNT(FE.PRODUCT_ID) AS COUNT
		FROM 
			WCA.FACT_EVENT FE,
			WCA.MEMBER M,
			WCA.PRODUCT PRO,
			WCA.PERIOD P,
			WCA.PRODUCT_REF PREF
		WHERE 
			M.MEMBER_ID = FE.MEMBER_ID
			AND PREF.LANGUAGE_ID IN (
			SELECT INTEGER (PR.PARAM_VALUE) 
			FROM WCA.PARAMETERS PR 
			WHERE PR.PARAM_TYPE='REPORT_LANGUAGE') 
			AND FE.STORE_ID IN ({storeent_id})
			AND FE.PRODUCT_ID = PRO.PRODUCT_ID
			AND PREF.PRODUCT_ID = FE.PRODUCT_ID
			AND FE.EVENT_TYPE_ID = 2
			AND FE.PER_ID = P.PER_ID
			AND (P.MON_OF_FY, FISCAL_YR) IN (
			SELECT
				MON_OF_FY,
				FISCAL_YR
			FROM
				WCA.PERIOD P
			WHERE
				P.CALENDAR_DATE=CURRENT DATE)

		GROUP BY
			FE.MEMBER_ID,
			FE.PRODUCT_ID,
			PRO.PARTNUM,
			M.FIRST_NAME,
			M.MIDDLE_NAME,
			M.LAST_NAME,
			PREF.SHORT_DESCRIPTION) AS T1
	WHERE
		 (T1.MEM_ID,T1.COUNT) IN(
		SELECT DISTINCT MEM_ID,MAX(COUNT)
		FROM(
			SELECT COUNT(FE.PRODUCT_ID) AS COUNT ,
				FE.MEMBER_ID AS MEM_ID,
				FE.PRODUCT_ID AS PR_ID 
			FROM 
				WCA.FACT_EVENT FE,
				WCA.MEMBER M,
				WCA.PRODUCT PRO,
				WCA.PERIOD P,
				WCA.PRODUCT_REF PREF
			WHERE 
				M.MEMBER_ID = FE.MEMBER_ID
				AND PREF.LANGUAGE_ID IN (
				SELECT INTEGER (PR.PARAM_VALUE) 
				FROM WCA.PARAMETERS PR 
				WHERE PR.PARAM_TYPE='REPORT_LANGUAGE') 
				AND FE.STORE_ID IN ({storeent_id})
				AND FE.PRODUCT_ID = PRO.PRODUCT_ID
				AND PREF.PRODUCT_ID = FE.PRODUCT_ID
				AND FE.EVENT_TYPE_ID = 2
				AND FE.PER_ID = P.PER_ID
				AND 
				(P.MON_OF_FY, FISCAL_YR) IN (
				SELECT
					MON_OF_FY,
					FISCAL_YR
				FROM
					WCA.PERIOD P
				WHERE
					P.CALENDAR_DATE=CURRENT DATE)

			GROUP BY
				FE.MEMBER_ID,
				FE.PRODUCT_ID
			) AS COUNT_TABLE
		GROUP BY
			MEM_ID
			) Order By 4 DESC
		</SQLvalue>
		<display>
			<standardInfo>
				<resourceBundle>bi.biNLS</resourceBundle>
				<title>BAProductsLookedAtBySingleUser</title>
				<message>BAProductsLookedAtBySingleUser</message>
			</standardInfo>
			<userDefinedParameters>
				<THStyle>TH { font-family : Times New Roman, Times, serif; font-size : 10pt; color : #565665; font-weight : bold; }</THStyle>
				<TDStyle>TD { font-family : Verdana,  Arial, Helvetica; font-size : 9pt; color : Black; }</TDStyle>
				<spaceBetweenColumns>25</spaceBetweenColumns>
				<columnDefaultAttributes>
					<displayInReport>true</displayInReport>
					<columnWidth>0</columnWidth>
					<maxEntryLength>999</maxEntryLength>
					<columnType>string</columnType>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columnDefaultAttributes>
				<columns>
					<columnKey>C0</columnKey>
					<columnName>userId</columnName>
					<columnOptions>ALIGN=RIGHT HEIGHT=20 NOWRAP</columnOptions>
					<columnType>integer</columnType>
				</columns>
				<columns>
					<columnKey>C1</columnKey>
					<columnName>userName</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C2</columnKey>
					<columnName>partNum</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C3</columnKey>
					<columnName>prodName</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C4</columnKey>
					<columnName>prodDescrip</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C5</columnKey>
					<columnName>numOfProdViewed</columnName>
					<columnOptions>ALIGN=RIGHT HEIGHT=20 NOWRAP</columnOptions>
					<columnType>integer</columnType>					
				</columns>
			</userDefinedParameters>
		</display>
	</Report>
		<Report reportName="biBAProductsLookedAtBySingleUserReportQuarterlyProductName" online="true" dataSourceName="WCA DataSource">
		<comment></comment>
		<SQLvalue>
SELECT  *
	FROM(
	SELECT 	FE.MEMBER_ID AS MEM_ID,
			COALESCE(M.FIRST_NAME,'') CONCAT (CASE WHEN M.FIRST_NAME IS NOT NULL AND M.MIDDLE_NAME IS NOT NULL THEN ' ' ELSE '' END CONCAT COALESCE(M.MIDDLE_NAME,'')) CONCAT ( CASE WHEN M.MIDDLE_NAME IS NOT NULL AND M.LAST_NAME IS NOT NULL THEN ' '  WHEN M.FIRST_NAME IS NOT NULL AND M.MIDDLE_NAME IS NULL AND M.LAST_NAME IS NOT NULL THEN ' ' ELSE '' END CONCAT  COALESCE(M.LAST_NAME,'') ) AS MEM_NAME,
			FE.PRODUCT_ID AS PR_ID,
			PREF.SHORT_DESCRIPTION,
			PRO.PARTNUM AS PARTNUM,
			COUNT(FE.PRODUCT_ID) AS COUNT
		FROM 
			WCA.FACT_EVENT FE,
			WCA.MEMBER M,
			WCA.PRODUCT PRO,
			WCA.PERIOD P,
			WCA.PRODUCT_REF PREF
		WHERE 
			M.MEMBER_ID = FE.MEMBER_ID
			AND PREF.LANGUAGE_ID IN (
			SELECT INTEGER (PR.PARAM_VALUE) 
			FROM WCA.PARAMETERS PR 
			WHERE PR.PARAM_TYPE='REPORT_LANGUAGE') 
			AND FE.STORE_ID IN ({storeent_id})
			AND FE.PRODUCT_ID = PRO.PRODUCT_ID
			AND PREF.PRODUCT_ID = FE.PRODUCT_ID
			AND FE.EVENT_TYPE_ID = 2
			AND FE.PER_ID = P.PER_ID
			AND (P.QTR_OF_FY, FISCAL_YR) IN (
				SELECT
					QTR_OF_FY,
					FISCAL_YR
				FROM
					WCA.PERIOD P
				WHERE
					P.CALENDAR_DATE=CURRENT DATE)
		GROUP BY
			FE.MEMBER_ID,
			FE.PRODUCT_ID,
			PRO.PARTNUM,
			M.FIRST_NAME,
			M.MIDDLE_NAME,
			M.LAST_NAME,
			PREF.SHORT_DESCRIPTION) AS T1
	WHERE
		 (T1.MEM_ID,T1.COUNT) IN(
		SELECT DISTINCT MEM_ID,MAX(COUNT)
		FROM(
			SELECT COUNT(FE.PRODUCT_ID) AS COUNT ,
				FE.MEMBER_ID AS MEM_ID,
				FE.PRODUCT_ID AS PR_ID 
			FROM 
				WCA.FACT_EVENT FE,
				WCA.MEMBER M,
				WCA.PRODUCT PRO,
				WCA.PERIOD P,
				WCA.PRODUCT_REF PREF
			WHERE 
				M.MEMBER_ID = FE.MEMBER_ID
				AND PREF.LANGUAGE_ID IN (
				SELECT INTEGER (PR.PARAM_VALUE) 
				FROM WCA.PARAMETERS PR 
				WHERE PR.PARAM_TYPE='REPORT_LANGUAGE') 
				AND FE.STORE_ID IN ({storeent_id})
				AND FE.PRODUCT_ID = PRO.PRODUCT_ID
				AND PREF.PRODUCT_ID = FE.PRODUCT_ID
				AND FE.EVENT_TYPE_ID = 2
				AND FE.PER_ID = P.PER_ID
				AND (P.QTR_OF_FY, FISCAL_YR) IN (
				SELECT
					QTR_OF_FY,
					FISCAL_YR
				FROM
					WCA.PERIOD P
				WHERE
					P.CALENDAR_DATE=CURRENT DATE)
			GROUP BY
				FE.MEMBER_ID,
				FE.PRODUCT_ID
			) AS COUNT_TABLE
		GROUP BY
			MEM_ID
			) Order By 4 DESC
		</SQLvalue>
		<display>
			<standardInfo>
				<resourceBundle>bi.biNLS</resourceBundle>
				<title>BAProductsLookedAtBySingleUser</title>
				<message>BAProductsLookedAtBySingleUser</message>
			</standardInfo>
			<userDefinedParameters>
				<THStyle>TH { font-family : Times New Roman, Times, serif; font-size : 10pt; color : #565665; font-weight : bold; }</THStyle>
				<TDStyle>TD { font-family : Verdana,  Arial, Helvetica; font-size : 9pt; color : Black; }</TDStyle>
				<spaceBetweenColumns>25</spaceBetweenColumns>
				<columnDefaultAttributes>
					<displayInReport>true</displayInReport>
					<columnWidth>0</columnWidth>
					<maxEntryLength>999</maxEntryLength>
					<columnType>string</columnType>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columnDefaultAttributes>
				<columns>
					<columnKey>C0</columnKey>
					<columnName>userId</columnName>
					<columnOptions>ALIGN=RIGHT HEIGHT=20 NOWRAP</columnOptions>
					<columnType>integer</columnType>
				</columns>
				<columns>
					<columnKey>C1</columnKey>
					<columnName>userName</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C2</columnKey>
					<columnName>partNum</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C3</columnKey>
					<columnName>prodName</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C4</columnKey>
					<columnName>prodDescrip</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C5</columnKey>
					<columnName>numOfProdViewed</columnName>
					<columnOptions>ALIGN=RIGHT HEIGHT=20 NOWRAP</columnOptions>
					<columnType>integer</columnType>					
				</columns>
			</userDefinedParameters>
		</display>
	</Report>
	<Report reportName="biBAProductsLookedAtBySingleUserReportYearlyProductName" online="true" dataSourceName="WCA DataSource">
		<comment></comment>
		<SQLvalue>
SELECT  *
	FROM(
	SELECT 	FE.MEMBER_ID AS MEM_ID,
			COALESCE(M.FIRST_NAME,'') CONCAT (CASE WHEN M.FIRST_NAME IS NOT NULL AND M.MIDDLE_NAME IS NOT NULL THEN ' ' ELSE '' END CONCAT COALESCE(M.MIDDLE_NAME,'')) CONCAT ( CASE WHEN M.MIDDLE_NAME IS NOT NULL AND M.LAST_NAME IS NOT NULL THEN ' '  WHEN M.FIRST_NAME IS NOT NULL AND M.MIDDLE_NAME IS NULL AND M.LAST_NAME IS NOT NULL THEN ' ' ELSE '' END CONCAT  COALESCE(M.LAST_NAME,'') ) AS MEM_NAME,
			FE.PRODUCT_ID AS PR_ID,
			PREF.SHORT_DESCRIPTION,
			PRO.PARTNUM AS PARTNUM,
			COUNT(FE.PRODUCT_ID) AS COUNT
		FROM 
			WCA.FACT_EVENT FE,
			WCA.MEMBER M,
			WCA.PRODUCT PRO,
			WCA.PERIOD P,
			WCA.PRODUCT_REF PREF
		WHERE 
			M.MEMBER_ID = FE.MEMBER_ID
			AND PREF.LANGUAGE_ID IN (
			SELECT INTEGER (PR.PARAM_VALUE) 
			FROM WCA.PARAMETERS PR 
			WHERE PR.PARAM_TYPE='REPORT_LANGUAGE') 
			AND FE.STORE_ID IN ({storeent_id})
			AND FE.PRODUCT_ID = PRO.PRODUCT_ID
			AND PREF.PRODUCT_ID = FE.PRODUCT_ID
			AND FE.EVENT_TYPE_ID = 2
			AND FE.PER_ID = P.PER_ID
			AND P.FISCAL_YR = (
			SELECT
				FISCAL_YR
			FROM
				WCA.PERIOD
			WHERE
				CALENDAR_DATE=CURRENT DATE)

		GROUP BY
			FE.MEMBER_ID,
			FE.PRODUCT_ID,
			PRO.PARTNUM,
			M.FIRST_NAME,
			M.MIDDLE_NAME,
			M.LAST_NAME,
			PREF.SHORT_DESCRIPTION) AS T1
	WHERE
		 (T1.MEM_ID,T1.COUNT) IN(
		SELECT DISTINCT MEM_ID,MAX(COUNT)
		FROM(
			SELECT COUNT(FE.PRODUCT_ID) AS COUNT ,
				FE.MEMBER_ID AS MEM_ID,
				FE.PRODUCT_ID AS PR_ID 
			FROM 
				WCA.FACT_EVENT FE,
				WCA.MEMBER M,
				WCA.PRODUCT PRO,
				WCA.PERIOD P,
				WCA.PRODUCT_REF PREF
			WHERE 
				M.MEMBER_ID = FE.MEMBER_ID
				AND PREF.LANGUAGE_ID IN (
				SELECT INTEGER (PR.PARAM_VALUE) 
				FROM WCA.PARAMETERS PR 
				WHERE PR.PARAM_TYPE='REPORT_LANGUAGE') 
				AND FE.STORE_ID IN ({storeent_id})
				AND FE.PRODUCT_ID = PRO.PRODUCT_ID
				AND PREF.PRODUCT_ID = FE.PRODUCT_ID
				AND FE.EVENT_TYPE_ID = 2
				AND FE.PER_ID = P.PER_ID
					AND P.FISCAL_YR = (
				SELECT
					FISCAL_YR
				FROM
					WCA.PERIOD
				WHERE
					CALENDAR_DATE=CURRENT DATE)

			GROUP BY
				FE.MEMBER_ID,
				FE.PRODUCT_ID
			) AS COUNT_TABLE
		GROUP BY
			MEM_ID
			) Order By 4 DESC
		</SQLvalue>
		<display>
			<standardInfo>
				<resourceBundle>bi.biNLS</resourceBundle>
				<title>BAProductsLookedAtBySingleUser</title>
				<message>BAProductsLookedAtBySingleUser</message>
			</standardInfo>
			<userDefinedParameters>
				<THStyle>TH { font-family : Times New Roman, Times, serif; font-size : 10pt; color : #565665; font-weight : bold; }</THStyle>
				<TDStyle>TD { font-family : Verdana,  Arial, Helvetica; font-size : 9pt; color : Black; }</TDStyle>
				<spaceBetweenColumns>25</spaceBetweenColumns>
				<columnDefaultAttributes>
					<displayInReport>true</displayInReport>
					<columnWidth>0</columnWidth>
					<maxEntryLength>999</maxEntryLength>
					<columnType>string</columnType>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columnDefaultAttributes>
				<columns>
					<columnKey>C0</columnKey>
					<columnName>userId</columnName>
					<columnOptions>ALIGN=RIGHT HEIGHT=20 NOWRAP</columnOptions>
					<columnType>integer</columnType>
				</columns>
				<columns>
					<columnKey>C1</columnKey>
					<columnName>userName</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C2</columnKey>
					<columnName>partNum</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C3</columnKey>
					<columnName>prodName</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C4</columnKey>
					<columnName>prodDescrip</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C5</columnKey>
					<columnName>numOfProdViewed</columnName>
					<columnOptions>ALIGN=RIGHT HEIGHT=20 NOWRAP</columnOptions>
					<columnType>integer</columnType>					
				</columns>
			</userDefinedParameters>
		</display>
	</Report>
	<Report reportName="biBAProductsLookedAtBySingleUserReportProductNameAscend" online="true" dataSourceName="WCA DataSource">
		<comment></comment>
		<SQLvalue>
SELECT  *
	FROM(
	SELECT 	FE.MEMBER_ID AS MEM_ID,
			COALESCE(M.FIRST_NAME,'') CONCAT (CASE WHEN M.FIRST_NAME IS NOT NULL AND M.MIDDLE_NAME IS NOT NULL THEN ' ' ELSE '' END CONCAT COALESCE(M.MIDDLE_NAME,'')) CONCAT ( CASE WHEN M.MIDDLE_NAME IS NOT NULL AND M.LAST_NAME IS NOT NULL THEN ' '  WHEN M.FIRST_NAME IS NOT NULL AND M.MIDDLE_NAME IS NULL AND M.LAST_NAME IS NOT NULL THEN ' ' ELSE '' END CONCAT  COALESCE(M.LAST_NAME,'') ) AS MEM_NAME,
			FE.PRODUCT_ID AS PR_ID,
			PREF.SHORT_DESCRIPTION,
			PRO.PARTNUM AS PARTNUM,
			COUNT(FE.PRODUCT_ID) AS COUNT
		FROM 
			WCA.FACT_EVENT FE,
			WCA.MEMBER M,
			WCA.PRODUCT PRO,
			WCA.PERIOD P,
			WCA.PRODUCT_REF PREF
		WHERE 
			M.MEMBER_ID = FE.MEMBER_ID
			AND PREF.LANGUAGE_ID IN (
			SELECT INTEGER (PR.PARAM_VALUE) 
			FROM WCA.PARAMETERS PR 
			WHERE PR.PARAM_TYPE='REPORT_LANGUAGE') 
			AND FE.STORE_ID IN ({storeent_id})
			AND FE.PRODUCT_ID = PRO.PRODUCT_ID
			AND PREF.PRODUCT_ID = FE.PRODUCT_ID
			AND FE.EVENT_TYPE_ID = 2
			AND FE.PER_ID = P.PER_ID
			AND P.CALENDAR_DATE &gt;= $DB_TIMESTAMP_FUNC({StartDate})$
 			AND P.CALENDAR_DATE &lt;= $DB_TIMESTAMP_FUNC({EndDate})$
		GROUP BY
			FE.MEMBER_ID,
			FE.PRODUCT_ID,
			PRO.PARTNUM,
			M.FIRST_NAME,
			M.MIDDLE_NAME,
			M.LAST_NAME,
			PREF.SHORT_DESCRIPTION) AS T1
	WHERE
		 (T1.MEM_ID,T1.COUNT) IN(
		SELECT DISTINCT MEM_ID,MAX(COUNT)
		FROM(
			SELECT COUNT(FE.PRODUCT_ID) AS COUNT ,
				FE.MEMBER_ID AS MEM_ID,
				FE.PRODUCT_ID AS PR_ID 
			FROM 
				WCA.FACT_EVENT FE,
				WCA.MEMBER M,
				WCA.PRODUCT PRO,
				WCA.PERIOD P,
				WCA.PRODUCT_REF PREF
			WHERE 
				M.MEMBER_ID = FE.MEMBER_ID
				AND PREF.LANGUAGE_ID IN (
				SELECT INTEGER (PR.PARAM_VALUE) 
				FROM WCA.PARAMETERS PR 
				WHERE PR.PARAM_TYPE='REPORT_LANGUAGE') 
				AND FE.STORE_ID IN ({storeent_id})
				AND FE.PRODUCT_ID = PRO.PRODUCT_ID
				AND PREF.PRODUCT_ID = FE.PRODUCT_ID
				AND FE.EVENT_TYPE_ID = 2
				AND FE.PER_ID = P.PER_ID
				AND P.CALENDAR_DATE = (Current date -1 Days)
			GROUP BY
				FE.MEMBER_ID,
				FE.PRODUCT_ID
			) AS COUNT_TABLE
		GROUP BY MEM_ID
		)
		Order By 4 ASC
		</SQLvalue>
		<display>
			<standardInfo>
				<resourceBundle>bi.biNLS</resourceBundle>
				<title>BAProductsLookedAtBySingleUser</title>
				<message>BAProductsLookedAtBySingleUser</message>
			</standardInfo>
			<userDefinedParameters>
				<THStyle>TH { font-family : Times New Roman, Times, serif; font-size : 10pt; color : #565665; font-weight : bold; }</THStyle>
				<TDStyle>TD { font-family : Verdana,  Arial, Helvetica; font-size : 9pt; color : Black; }</TDStyle>
				<spaceBetweenColumns>25</spaceBetweenColumns>
				<columnDefaultAttributes>
					<displayInReport>true</displayInReport>
					<columnWidth>0</columnWidth>
					<maxEntryLength>999</maxEntryLength>
					<columnType>string</columnType>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columnDefaultAttributes>
				<columns>
					<columnKey>C0</columnKey>
					<columnName>userId</columnName>
					<columnOptions>ALIGN=RIGHT HEIGHT=20 NOWRAP</columnOptions>
					<columnType>integer</columnType>
				</columns>
				<columns>
					<columnKey>C1</columnKey>
					<columnName>userName</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C2</columnKey>
					<columnName>partNum</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C3</columnKey>
					<columnName>prodName</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C4</columnKey>
					<columnName>prodDescrip</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C5</columnKey>
					<columnName>numOfProdViewed</columnName>
					<columnOptions>ALIGN=RIGHT HEIGHT=20 NOWRAP</columnOptions>
					<columnType>integer</columnType>					
				</columns>
			</userDefinedParameters>
		</display>
	</Report>
	<Report reportName="biBAProductsLookedAtBySingleUserReportYesterdayProductNameAscend" online="true" dataSourceName="WCA DataSource">
		<comment></comment>
		<SQLvalue>
SELECT  *
	FROM(
	SELECT 	FE.MEMBER_ID AS MEM_ID,
			COALESCE(M.FIRST_NAME,'') CONCAT (CASE WHEN M.FIRST_NAME IS NOT NULL AND M.MIDDLE_NAME IS NOT NULL THEN ' ' ELSE '' END CONCAT COALESCE(M.MIDDLE_NAME,'')) CONCAT ( CASE WHEN M.MIDDLE_NAME IS NOT NULL AND M.LAST_NAME IS NOT NULL THEN ' '  WHEN M.FIRST_NAME IS NOT NULL AND M.MIDDLE_NAME IS NULL AND M.LAST_NAME IS NOT NULL THEN ' ' ELSE '' END CONCAT  COALESCE(M.LAST_NAME,'') ) AS MEM_NAME,
			FE.PRODUCT_ID AS PR_ID,
			PREF.SHORT_DESCRIPTION,
			PRO.PARTNUM AS PARTNUM,
			COUNT(FE.PRODUCT_ID) AS COUNT
		FROM 
			WCA.FACT_EVENT FE,
			WCA.MEMBER M,
			WCA.PRODUCT PRO,
			WCA.PERIOD P,
			WCA.PRODUCT_REF PREF
		WHERE 
			M.MEMBER_ID = FE.MEMBER_ID
			AND PREF.LANGUAGE_ID IN (
			SELECT INTEGER (PR.PARAM_VALUE) 
			FROM WCA.PARAMETERS PR 
			WHERE PR.PARAM_TYPE='REPORT_LANGUAGE') 
			AND FE.STORE_ID IN ({storeent_id})
			AND FE.PRODUCT_ID = PRO.PRODUCT_ID
			AND PREF.PRODUCT_ID = FE.PRODUCT_ID
			AND FE.EVENT_TYPE_ID = 2
			AND FE.PER_ID = P.PER_ID
			AND P.CALENDAR_DATE = (Current date -1 Days)
		GROUP BY
			FE.MEMBER_ID,
			FE.PRODUCT_ID,
			PRO.PARTNUM,
			M.FIRST_NAME,
			M.MIDDLE_NAME,
			M.LAST_NAME,
			PREF.SHORT_DESCRIPTION) AS T1
	WHERE
		 (T1.MEM_ID,T1.COUNT) IN(
		SELECT DISTINCT MEM_ID,MAX(COUNT)
		FROM(
			SELECT COUNT(FE.PRODUCT_ID) AS COUNT ,
				FE.MEMBER_ID AS MEM_ID,
				FE.PRODUCT_ID AS PR_ID 
			FROM 
				WCA.FACT_EVENT FE,
				WCA.MEMBER M,
				WCA.PRODUCT PRO,
				WCA.PERIOD P,
				WCA.PRODUCT_REF PREF
			WHERE 
				M.MEMBER_ID = FE.MEMBER_ID
				AND PREF.LANGUAGE_ID IN (
				SELECT INTEGER (PR.PARAM_VALUE) 
				FROM WCA.PARAMETERS PR 
				WHERE PR.PARAM_TYPE='REPORT_LANGUAGE') 
				AND FE.STORE_ID IN ({storeent_id})
				AND FE.PRODUCT_ID = PRO.PRODUCT_ID
				AND PREF.PRODUCT_ID = FE.PRODUCT_ID
				AND FE.EVENT_TYPE_ID = 2
				AND FE.PER_ID = P.PER_ID
				AND P.CALENDAR_DATE = (Current date -1 Days)
			GROUP BY
				FE.MEMBER_ID,
				FE.PRODUCT_ID
			) AS COUNT_TABLE
		GROUP BY
			MEM_ID
			) Order By 4 ASC
		</SQLvalue>
		<display>
			<standardInfo>
				<resourceBundle>bi.biNLS</resourceBundle>
				<title>BAProductsLookedAtBySingleUser</title>
				<message>BAProductsLookedAtBySingleUser</message>
			</standardInfo>
			<userDefinedParameters>
				<THStyle>TH { font-family : Times New Roman, Times, serif; font-size : 10pt; color : #565665; font-weight : bold; }</THStyle>
				<TDStyle>TD { font-family : Verdana,  Arial, Helvetica; font-size : 9pt; color : Black; }</TDStyle>
				<spaceBetweenColumns>25</spaceBetweenColumns>
				<columnDefaultAttributes>
					<displayInReport>true</displayInReport>
					<columnWidth>0</columnWidth>
					<maxEntryLength>999</maxEntryLength>
					<columnType>string</columnType>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columnDefaultAttributes>
				<columns>
					<columnKey>C0</columnKey>
					<columnName>userId</columnName>
					<columnOptions>ALIGN=RIGHT HEIGHT=20 NOWRAP</columnOptions>
					<columnType>integer</columnType>
				</columns>
				<columns>
					<columnKey>C1</columnKey>
					<columnName>userName</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C2</columnKey>
					<columnName>partNum</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C3</columnKey>
					<columnName>prodName</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C4</columnKey>
					<columnName>prodDescrip</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C5</columnKey>
					<columnName>numOfProdViewed</columnName>
					<columnOptions>ALIGN=RIGHT HEIGHT=20 NOWRAP</columnOptions>
					<columnType>integer</columnType>					
				</columns>
			</userDefinedParameters>
		</display>
	</Report>
	<Report reportName="biBAProductsLookedAtBySingleUserReportWeeklyProductNameAscend" online="true" dataSourceName="WCA DataSource">
		<comment></comment>
		<SQLvalue>
SELECT  *
	FROM(
	SELECT 	FE.MEMBER_ID AS MEM_ID,
			COALESCE(M.FIRST_NAME,'') CONCAT (CASE WHEN M.FIRST_NAME IS NOT NULL AND M.MIDDLE_NAME IS NOT NULL THEN ' ' ELSE '' END CONCAT COALESCE(M.MIDDLE_NAME,'')) CONCAT ( CASE WHEN M.MIDDLE_NAME IS NOT NULL AND M.LAST_NAME IS NOT NULL THEN ' '  WHEN M.FIRST_NAME IS NOT NULL AND M.MIDDLE_NAME IS NULL AND M.LAST_NAME IS NOT NULL THEN ' ' ELSE '' END CONCAT  COALESCE(M.LAST_NAME,'') ) AS MEM_NAME,
			FE.PRODUCT_ID AS PR_ID,
			PREF.SHORT_DESCRIPTION,
			PRO.PARTNUM AS PARTNUM,
			COUNT(FE.PRODUCT_ID) AS COUNT
		FROM 
			WCA.FACT_EVENT FE,
			WCA.MEMBER M,
			WCA.PRODUCT PRO,
			WCA.PERIOD P,
			WCA.PRODUCT_REF PREF
		WHERE 
			M.MEMBER_ID = FE.MEMBER_ID
			AND PREF.LANGUAGE_ID IN (
			SELECT INTEGER (PR.PARAM_VALUE) 
			FROM WCA.PARAMETERS PR 
			WHERE PR.PARAM_TYPE='REPORT_LANGUAGE') 
			AND FE.STORE_ID IN ({storeent_id})
			AND FE.PRODUCT_ID = PRO.PRODUCT_ID
			AND PREF.PRODUCT_ID = FE.PRODUCT_ID
			AND FE.EVENT_TYPE_ID = 2
			AND FE.PER_ID = P.PER_ID
						AND 
				(P.WK_OF_FY, FISCAL_YR) IN (
				SELECT
					WK_OF_FY,
					FISCAL_YR
				FROM
					WCA.PERIOD P
				WHERE
					P.CALENDAR_DATE=CURRENT DATE)

		GROUP BY
			FE.MEMBER_ID,
			FE.PRODUCT_ID,
			PRO.PARTNUM,
			M.FIRST_NAME,
			M.MIDDLE_NAME,
			M.LAST_NAME,
			PREF.SHORT_DESCRIPTION) AS T1
	WHERE
		 (T1.MEM_ID,T1.COUNT) IN(
		SELECT DISTINCT MEM_ID,MAX(COUNT)
		FROM(
			SELECT COUNT(FE.PRODUCT_ID) AS COUNT ,
				FE.MEMBER_ID AS MEM_ID,
				FE.PRODUCT_ID AS PR_ID 
			FROM 
				WCA.FACT_EVENT FE,
				WCA.MEMBER M,
				WCA.PRODUCT PRO,
				WCA.PERIOD P,
				WCA.PRODUCT_REF PREF
			WHERE 
				M.MEMBER_ID = FE.MEMBER_ID
				AND PREF.LANGUAGE_ID IN (
				SELECT INTEGER (PR.PARAM_VALUE) 
				FROM WCA.PARAMETERS PR 
				WHERE PR.PARAM_TYPE='REPORT_LANGUAGE') 
				AND FE.STORE_ID IN ({storeent_id})
				AND FE.PRODUCT_ID = PRO.PRODUCT_ID
				AND PREF.PRODUCT_ID = FE.PRODUCT_ID
				AND FE.EVENT_TYPE_ID = 2
				AND FE.PER_ID = P.PER_ID
							AND 
				(P.WK_OF_FY, FISCAL_YR) IN (
				SELECT
					WK_OF_FY,
					FISCAL_YR
				FROM
					WCA.PERIOD P
				WHERE
					P.CALENDAR_DATE=CURRENT DATE)

			GROUP BY
				FE.MEMBER_ID,
				FE.PRODUCT_ID
			) AS COUNT_TABLE
		GROUP BY
			MEM_ID
			) Order By 4 ASC
		</SQLvalue>
		<display>
			<standardInfo>
				<resourceBundle>bi.biNLS</resourceBundle>
				<title>BAProductsLookedAtBySingleUser</title>
				<message>BAProductsLookedAtBySingleUser</message>
			</standardInfo>
			<userDefinedParameters>
				<THStyle>TH { font-family : Times New Roman, Times, serif; font-size : 10pt; color : #565665; font-weight : bold; }</THStyle>
				<TDStyle>TD { font-family : Verdana,  Arial, Helvetica; font-size : 9pt; color : Black; }</TDStyle>
				<spaceBetweenColumns>25</spaceBetweenColumns>
				<columnDefaultAttributes>
					<displayInReport>true</displayInReport>
					<columnWidth>0</columnWidth>
					<maxEntryLength>999</maxEntryLength>
					<columnType>string</columnType>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columnDefaultAttributes>
				<columns>
					<columnKey>C0</columnKey>
					<columnName>userId</columnName>
					<columnOptions>ALIGN=RIGHT HEIGHT=20 NOWRAP</columnOptions>
					<columnType>integer</columnType>
				</columns>
				<columns>
					<columnKey>C1</columnKey>
					<columnName>userName</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C2</columnKey>
					<columnName>partNum</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C3</columnKey>
					<columnName>prodName</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C4</columnKey>
					<columnName>prodDescrip</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C5</columnKey>
					<columnName>numOfProdViewed</columnName>
					<columnOptions>ALIGN=RIGHT HEIGHT=20 NOWRAP</columnOptions>
					<columnType>integer</columnType>					
				</columns>
			</userDefinedParameters>
		</display>
	</Report>
	<Report reportName="biBAProductsLookedAtBySingleUserReportMonthlyProductNameAscend" online="true" dataSourceName="WCA DataSource">
		<comment></comment>
		<SQLvalue>
SELECT  *
	FROM(
	SELECT 	FE.MEMBER_ID AS MEM_ID,
			COALESCE(M.FIRST_NAME,'') CONCAT (CASE WHEN M.FIRST_NAME IS NOT NULL AND M.MIDDLE_NAME IS NOT NULL THEN ' ' ELSE '' END CONCAT COALESCE(M.MIDDLE_NAME,'')) CONCAT ( CASE WHEN M.MIDDLE_NAME IS NOT NULL AND M.LAST_NAME IS NOT NULL THEN ' '  WHEN M.FIRST_NAME IS NOT NULL AND M.MIDDLE_NAME IS NULL AND M.LAST_NAME IS NOT NULL THEN ' ' ELSE '' END CONCAT  COALESCE(M.LAST_NAME,'') ) AS MEM_NAME,
			FE.PRODUCT_ID AS PR_ID,
			PREF.SHORT_DESCRIPTION,
			PRO.PARTNUM AS PARTNUM,
			COUNT(FE.PRODUCT_ID) AS COUNT
		FROM 
			WCA.FACT_EVENT FE,
			WCA.MEMBER M,
			WCA.PRODUCT PRO,
			WCA.PERIOD P,
			WCA.PRODUCT_REF PREF
		WHERE 
			M.MEMBER_ID = FE.MEMBER_ID
			AND PREF.LANGUAGE_ID IN (
			SELECT INTEGER (PR.PARAM_VALUE) 
			FROM WCA.PARAMETERS PR 
			WHERE PR.PARAM_TYPE='REPORT_LANGUAGE') 
			AND FE.STORE_ID IN ({storeent_id})
			AND FE.PRODUCT_ID = PRO.PRODUCT_ID
			AND PREF.PRODUCT_ID = FE.PRODUCT_ID
			AND FE.EVENT_TYPE_ID = 2
			AND FE.PER_ID = P.PER_ID
			AND (P.MON_OF_FY, FISCAL_YR) IN (
			SELECT
				MON_OF_FY,
				FISCAL_YR
			FROM
				WCA.PERIOD P
			WHERE
				P.CALENDAR_DATE=CURRENT DATE)

		GROUP BY
			FE.MEMBER_ID,
			FE.PRODUCT_ID,
			PRO.PARTNUM,
			M.FIRST_NAME,
			M.MIDDLE_NAME,
			M.LAST_NAME,
			PREF.SHORT_DESCRIPTION) AS T1
	WHERE
		 (T1.MEM_ID,T1.COUNT) IN(
		SELECT DISTINCT MEM_ID,MAX(COUNT)
		FROM(
			SELECT COUNT(FE.PRODUCT_ID) AS COUNT ,
				FE.MEMBER_ID AS MEM_ID,
				FE.PRODUCT_ID AS PR_ID 
			FROM 
				WCA.FACT_EVENT FE,
				WCA.MEMBER M,
				WCA.PRODUCT PRO,
				WCA.PERIOD P,
				WCA.PRODUCT_REF PREF
			WHERE 
				M.MEMBER_ID = FE.MEMBER_ID
				AND PREF.LANGUAGE_ID IN (
				SELECT INTEGER (PR.PARAM_VALUE) 
				FROM WCA.PARAMETERS PR 
				WHERE PR.PARAM_TYPE='REPORT_LANGUAGE') 
				AND FE.STORE_ID IN ({storeent_id})
				AND FE.PRODUCT_ID = PRO.PRODUCT_ID
				AND PREF.PRODUCT_ID = FE.PRODUCT_ID
				AND FE.EVENT_TYPE_ID = 2
				AND FE.PER_ID = P.PER_ID
				AND 
				(P.MON_OF_FY, FISCAL_YR) IN (
				SELECT
					MON_OF_FY,
					FISCAL_YR
				FROM
					WCA.PERIOD P
				WHERE
					P.CALENDAR_DATE=CURRENT DATE)

			GROUP BY
				FE.MEMBER_ID,
				FE.PRODUCT_ID
			) AS COUNT_TABLE
		GROUP BY
			MEM_ID
			) Order By 4 ASC
		</SQLvalue>
		<display>
			<standardInfo>
				<resourceBundle>bi.biNLS</resourceBundle>
				<title>BAProductsLookedAtBySingleUser</title>
				<message>BAProductsLookedAtBySingleUser</message>
			</standardInfo>
			<userDefinedParameters>
				<THStyle>TH { font-family : Times New Roman, Times, serif; font-size : 10pt; color : #565665; font-weight : bold; }</THStyle>
				<TDStyle>TD { font-family : Verdana,  Arial, Helvetica; font-size : 9pt; color : Black; }</TDStyle>
				<spaceBetweenColumns>25</spaceBetweenColumns>
				<columnDefaultAttributes>
					<displayInReport>true</displayInReport>
					<columnWidth>0</columnWidth>
					<maxEntryLength>999</maxEntryLength>
					<columnType>string</columnType>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columnDefaultAttributes>
				<columns>
					<columnKey>C0</columnKey>
					<columnName>userId</columnName>
					<columnOptions>ALIGN=RIGHT HEIGHT=20 NOWRAP</columnOptions>
					<columnType>integer</columnType>
				</columns>
				<columns>
					<columnKey>C1</columnKey>
					<columnName>userName</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C2</columnKey>
					<columnName>partNum</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C3</columnKey>
					<columnName>prodName</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C4</columnKey>
					<columnName>prodDescrip</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C5</columnKey>
					<columnName>numOfProdViewed</columnName>
					<columnOptions>ALIGN=RIGHT HEIGHT=20 NOWRAP</columnOptions>
					<columnType>integer</columnType>					
				</columns>
			</userDefinedParameters>
		</display>
	</Report>
		<Report reportName="biBAProductsLookedAtBySingleUserReportQuarterlyProductNameAscend" online="true" dataSourceName="WCA DataSource">
		<comment></comment>
		<SQLvalue>
SELECT  *
	FROM(
	SELECT 	FE.MEMBER_ID AS MEM_ID,
			COALESCE(M.FIRST_NAME,'') CONCAT (CASE WHEN M.FIRST_NAME IS NOT NULL AND M.MIDDLE_NAME IS NOT NULL THEN ' ' ELSE '' END CONCAT COALESCE(M.MIDDLE_NAME,'')) CONCAT ( CASE WHEN M.MIDDLE_NAME IS NOT NULL AND M.LAST_NAME IS NOT NULL THEN ' '  WHEN M.FIRST_NAME IS NOT NULL AND M.MIDDLE_NAME IS NULL AND M.LAST_NAME IS NOT NULL THEN ' ' ELSE '' END CONCAT  COALESCE(M.LAST_NAME,'') ) AS MEM_NAME,
			FE.PRODUCT_ID AS PR_ID,
			PREF.SHORT_DESCRIPTION,
			PRO.PARTNUM AS PARTNUM,
			COUNT(FE.PRODUCT_ID) AS COUNT
		FROM 
			WCA.FACT_EVENT FE,
			WCA.MEMBER M,
			WCA.PRODUCT PRO,
			WCA.PERIOD P,
			WCA.PRODUCT_REF PREF
		WHERE 
			M.MEMBER_ID = FE.MEMBER_ID
			AND PREF.LANGUAGE_ID IN (
			SELECT INTEGER (PR.PARAM_VALUE) 
			FROM WCA.PARAMETERS PR 
			WHERE PR.PARAM_TYPE='REPORT_LANGUAGE') 
			AND FE.STORE_ID IN ({storeent_id})
			AND FE.PRODUCT_ID = PRO.PRODUCT_ID
			AND PREF.PRODUCT_ID = FE.PRODUCT_ID
			AND FE.EVENT_TYPE_ID = 2
			AND FE.PER_ID = P.PER_ID
			AND (P.QTR_OF_FY, FISCAL_YR) IN (
				SELECT
					QTR_OF_FY,
					FISCAL_YR
				FROM
					WCA.PERIOD P
				WHERE
					P.CALENDAR_DATE=CURRENT DATE)
		GROUP BY
			FE.MEMBER_ID,
			FE.PRODUCT_ID,
			PRO.PARTNUM,
			M.FIRST_NAME,
			M.MIDDLE_NAME,
			M.LAST_NAME,
			PREF.SHORT_DESCRIPTION) AS T1
	WHERE
		 (T1.MEM_ID,T1.COUNT) IN(
		SELECT DISTINCT MEM_ID,MAX(COUNT)
		FROM(
			SELECT COUNT(FE.PRODUCT_ID) AS COUNT ,
				FE.MEMBER_ID AS MEM_ID,
				FE.PRODUCT_ID AS PR_ID 
			FROM 
				WCA.FACT_EVENT FE,
				WCA.MEMBER M,
				WCA.PRODUCT PRO,
				WCA.PERIOD P,
				WCA.PRODUCT_REF PREF
			WHERE 
				M.MEMBER_ID = FE.MEMBER_ID
				AND PREF.LANGUAGE_ID IN (
				SELECT INTEGER (PR.PARAM_VALUE) 
				FROM WCA.PARAMETERS PR 
				WHERE PR.PARAM_TYPE='REPORT_LANGUAGE') 
				AND FE.STORE_ID IN ({storeent_id})
				AND FE.PRODUCT_ID = PRO.PRODUCT_ID
				AND PREF.PRODUCT_ID = FE.PRODUCT_ID
				AND FE.EVENT_TYPE_ID = 2
				AND FE.PER_ID = P.PER_ID
				AND (P.QTR_OF_FY, FISCAL_YR) IN (
				SELECT
					QTR_OF_FY,
					FISCAL_YR
				FROM
					WCA.PERIOD P
				WHERE
					P.CALENDAR_DATE=CURRENT DATE)
			GROUP BY
				FE.MEMBER_ID,
				FE.PRODUCT_ID
			) AS COUNT_TABLE
		GROUP BY
			MEM_ID
			) Order By 4 ASC
		</SQLvalue>
		<display>
			<standardInfo>
				<resourceBundle>bi.biNLS</resourceBundle>
				<title>BAProductsLookedAtBySingleUser</title>
				<message>BAProductsLookedAtBySingleUser</message>
			</standardInfo>
			<userDefinedParameters>
				<THStyle>TH { font-family : Times New Roman, Times, serif; font-size : 10pt; color : #565665; font-weight : bold; }</THStyle>
				<TDStyle>TD { font-family : Verdana,  Arial, Helvetica; font-size : 9pt; color : Black; }</TDStyle>
				<spaceBetweenColumns>25</spaceBetweenColumns>
				<columnDefaultAttributes>
					<displayInReport>true</displayInReport>
					<columnWidth>0</columnWidth>
					<maxEntryLength>999</maxEntryLength>
					<columnType>string</columnType>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columnDefaultAttributes>
				<columns>
					<columnKey>C0</columnKey>
					<columnName>userId</columnName>
					<columnOptions>ALIGN=RIGHT HEIGHT=20 NOWRAP</columnOptions>
					<columnType>integer</columnType>
				</columns>
				<columns>
					<columnKey>C1</columnKey>
					<columnName>userName</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C2</columnKey>
					<columnName>partNum</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C3</columnKey>
					<columnName>prodName</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C4</columnKey>
					<columnName>prodDescrip</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C5</columnKey>
					<columnName>numOfProdViewed</columnName>
					<columnOptions>ALIGN=RIGHT HEIGHT=20 NOWRAP</columnOptions>
					<columnType>integer</columnType>					
				</columns>
			</userDefinedParameters>
		</display>
	</Report>
	<Report reportName="biBAProductsLookedAtBySingleUserReportYearlyProductNameAscend" online="true" dataSourceName="WCA DataSource">
		<comment></comment>
		<SQLvalue>
SELECT  *
	FROM(
	SELECT 	FE.MEMBER_ID AS MEM_ID,
			COALESCE(M.FIRST_NAME,'') CONCAT (CASE WHEN M.FIRST_NAME IS NOT NULL AND M.MIDDLE_NAME IS NOT NULL THEN ' ' ELSE '' END CONCAT COALESCE(M.MIDDLE_NAME,'')) CONCAT ( CASE WHEN M.MIDDLE_NAME IS NOT NULL AND M.LAST_NAME IS NOT NULL THEN ' '  WHEN M.FIRST_NAME IS NOT NULL AND M.MIDDLE_NAME IS NULL AND M.LAST_NAME IS NOT NULL THEN ' ' ELSE '' END CONCAT  COALESCE(M.LAST_NAME,'') ) AS MEM_NAME,
			FE.PRODUCT_ID AS PR_ID,
			PREF.SHORT_DESCRIPTION,
			PRO.PARTNUM AS PARTNUM,
			COUNT(FE.PRODUCT_ID) AS COUNT
		FROM 
			WCA.FACT_EVENT FE,
			WCA.MEMBER M,
			WCA.PRODUCT PRO,
			WCA.PERIOD P,
			WCA.PRODUCT_REF PREF
		WHERE 
			M.MEMBER_ID = FE.MEMBER_ID
			AND PREF.LANGUAGE_ID IN (
			SELECT INTEGER (PR.PARAM_VALUE) 
			FROM WCA.PARAMETERS PR 
			WHERE PR.PARAM_TYPE='REPORT_LANGUAGE') 
			AND FE.STORE_ID IN ({storeent_id})
			AND FE.PRODUCT_ID = PRO.PRODUCT_ID
			AND PREF.PRODUCT_ID = FE.PRODUCT_ID
			AND FE.EVENT_TYPE_ID = 2
			AND FE.PER_ID = P.PER_ID
			AND P.FISCAL_YR = (
			SELECT
				FISCAL_YR
			FROM
				WCA.PERIOD
			WHERE
				CALENDAR_DATE=CURRENT DATE)

		GROUP BY
			FE.MEMBER_ID,
			FE.PRODUCT_ID,
			PRO.PARTNUM,
			M.FIRST_NAME,
			M.MIDDLE_NAME,
			M.LAST_NAME,
			PREF.SHORT_DESCRIPTION) AS T1
	WHERE
		 (T1.MEM_ID,T1.COUNT) IN(
		SELECT DISTINCT MEM_ID,MAX(COUNT)
		FROM(
			SELECT COUNT(FE.PRODUCT_ID) AS COUNT ,
				FE.MEMBER_ID AS MEM_ID,
				FE.PRODUCT_ID AS PR_ID 
			FROM 
				WCA.FACT_EVENT FE,
				WCA.MEMBER M,
				WCA.PRODUCT PRO,
				WCA.PERIOD P,
				WCA.PRODUCT_REF PREF
			WHERE 
				M.MEMBER_ID = FE.MEMBER_ID
				AND PREF.LANGUAGE_ID IN (
				SELECT INTEGER (PR.PARAM_VALUE) 
				FROM WCA.PARAMETERS PR 
				WHERE PR.PARAM_TYPE='REPORT_LANGUAGE') 
				AND FE.STORE_ID IN ({storeent_id})
				AND FE.PRODUCT_ID = PRO.PRODUCT_ID
				AND PREF.PRODUCT_ID = FE.PRODUCT_ID
				AND FE.EVENT_TYPE_ID = 2
				AND FE.PER_ID = P.PER_ID
					AND P.FISCAL_YR = (
				SELECT
					FISCAL_YR
				FROM
					WCA.PERIOD
				WHERE
					CALENDAR_DATE=CURRENT DATE)

			GROUP BY
				FE.MEMBER_ID,
				FE.PRODUCT_ID
			) AS COUNT_TABLE
		GROUP BY
			MEM_ID
			) Order By 4 ASC
		</SQLvalue>
		<display>
			<standardInfo>
				<resourceBundle>bi.biNLS</resourceBundle>
				<title>BAProductsLookedAtBySingleUser</title>
				<message>BAProductsLookedAtBySingleUser</message>
			</standardInfo>
			<userDefinedParameters>
				<THStyle>TH { font-family : Times New Roman, Times, serif; font-size : 10pt; color : #565665; font-weight : bold; }</THStyle>
				<TDStyle>TD { font-family : Verdana,  Arial, Helvetica; font-size : 9pt; color : Black; }</TDStyle>
				<spaceBetweenColumns>25</spaceBetweenColumns>
				<columnDefaultAttributes>
					<displayInReport>true</displayInReport>
					<columnWidth>0</columnWidth>
					<maxEntryLength>999</maxEntryLength>
					<columnType>string</columnType>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columnDefaultAttributes>
				<columns>
					<columnKey>C0</columnKey>
					<columnName>userId</columnName>
					<columnOptions>ALIGN=RIGHT HEIGHT=20 NOWRAP</columnOptions>
					<columnType>integer</columnType>
				</columns>
				<columns>
					<columnKey>C1</columnKey>
					<columnName>userName</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C2</columnKey>
					<columnName>partNum</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C3</columnKey>
					<columnName>prodName</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C4</columnKey>
					<columnName>prodDescrip</columnName>
					<columnOptions>ALIGN=LEFT HEIGHT=20 NOWRAP</columnOptions>
				</columns>
				<columns>
					<columnKey>C5</columnKey>
					<columnName>numOfProdViewed</columnName>
					<columnOptions>ALIGN=RIGHT HEIGHT=20 NOWRAP</columnOptions>
					<columnType>integer</columnType>					
				</columns>
			</userDefinedParameters>
		</display>
	</Report>
</Reporting>